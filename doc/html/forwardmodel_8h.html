<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>rjmcmc: forwardmodel.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rjmcmc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_e94b1eae9eca23b6cf7edc200de068b1.html">rjmcmc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">forwardmodel.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Simple Forward Model Routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="rjmcmc__config_8h_source.html">rjmcmc/rjmcmc_config.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="resultsetfm_8h_source.html">rjmcmc/resultsetfm.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="resultset1dfm_8h_source.html">rjmcmc/resultset1dfm.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="resultset2dfm_8h_source.html">rjmcmc/resultset2dfm.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="bbox2d_8h_source.html">rjmcmc/bbox2d.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="rjmcmc__random_8h_source.html">rjmcmc/rjmcmc_random.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for forwardmodel.h:</div>
<div class="dyncontent">
<div class="center"><img src="forwardmodel_8h__incl.png" border="0" usemap="#forwardmodel_8h" alt=""/></div>
<!-- MAP 0 -->
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="forwardmodel_8h__dep__incl.png" border="0" usemap="#forwardmodel_8hdep" alt=""/></div>
<!-- MAP 1 -->
</div>
</div>
<p><a href="forwardmodel_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a094bcc9790c7865c0a721078d5334420"><td class="memItemLeft" align="right" valign="top">typedef double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a094bcc9790c7865c0a721078d5334420">single_fm_likelihood_t</a>) (void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int n, const double *values)</td></tr>
<tr class="separator:a094bcc9790c7865c0a721078d5334420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a68d1e54609fed41954a0469e16d2c"><td class="memItemLeft" align="right" valign="top">typedef double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a20a68d1e54609fed41954a0469e16d2c">single_fm_likelihood_hierarchical_t</a>) (void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int nvalues, const double *values, int hierarchical_proposal, int nhierarchicalvalues, const double *hierarchicalvalues, double *logdetCe)</td></tr>
<tr class="separator:a20a68d1e54609fed41954a0469e16d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3cac657468dcba4666b4eb0e6014c97"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__part1d__fm__likelihood__state.html">_part1d_fm_likelihood_state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#ab3cac657468dcba4666b4eb0e6014c97">part1d_fm_likelihood_state_t</a></td></tr>
<tr class="separator:ab3cac657468dcba4666b4eb0e6014c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0748a5b083292dc628303c679b25b2f"><td class="memItemLeft" align="right" valign="top">typedef const double *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#ae0748a5b083292dc628303c679b25b2f">part1d_fm_value_at_t</a>) (<a class="el" href="forwardmodel_8h.html#ab3cac657468dcba4666b4eb0e6014c97">part1d_fm_likelihood_state_t</a> *state, double <a class="el" href="wellrng_8c.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>)</td></tr>
<tr class="separator:ae0748a5b083292dc628303c679b25b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55c6095922233bbf09da18c6f3735642"><td class="memItemLeft" align="right" valign="top">typedef double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a>) (void *userarg, int npartitions, const double *partition_boundaries, int nglobalparameters, const double *global_parameters, <a class="el" href="forwardmodel_8h.html#ab3cac657468dcba4666b4eb0e6014c97">part1d_fm_likelihood_state_t</a> *state, <a class="el" href="forwardmodel_8h.html#ae0748a5b083292dc628303c679b25b2f">part1d_fm_value_at_t</a> value_at, <a class="el" href="forwardmodel_8h.html#ae0748a5b083292dc628303c679b25b2f">part1d_fm_value_at_t</a> gradient_at)</td></tr>
<tr class="separator:a55c6095922233bbf09da18c6f3735642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2026ad82eb4444663fea75d67fd619d3"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__part1d__fm__hierarchical__likelihood__state.html">_part1d_fm_hierarchical_likelihood_state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a2026ad82eb4444663fea75d67fd619d3">part1d_fm_hierarchical_likelihood_state_t</a></td></tr>
<tr class="separator:a2026ad82eb4444663fea75d67fd619d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b43e47273fdb108e220e5418db7496e"><td class="memItemLeft" align="right" valign="top">typedef const double *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a2b43e47273fdb108e220e5418db7496e">part1d_fm_hierarchical_value_at_t</a>) (<a class="el" href="forwardmodel_8h.html#a2026ad82eb4444663fea75d67fd619d3">part1d_fm_hierarchical_likelihood_state_t</a> *state, double <a class="el" href="wellrng_8c.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>)</td></tr>
<tr class="separator:a2b43e47273fdb108e220e5418db7496e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab52d410e89a70e92c92362c32d135e45"><td class="memItemLeft" align="right" valign="top">typedef double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#ab52d410e89a70e92c92362c32d135e45">part1d_fm_hierarchical_likelihood_t</a>) (void *userarg, int npartitions, const double *partition_boundaries, int nglobalparameters, const double *global_parameters, int hierarchical, int nhierarchicalparameters, const double *heirarchical_parameters, <a class="el" href="forwardmodel_8h.html#a2026ad82eb4444663fea75d67fd619d3">part1d_fm_hierarchical_likelihood_state_t</a> *state, <a class="el" href="forwardmodel_8h.html#a2b43e47273fdb108e220e5418db7496e">part1d_fm_hierarchical_value_at_t</a> value_at, <a class="el" href="forwardmodel_8h.html#a2b43e47273fdb108e220e5418db7496e">part1d_fm_hierarchical_value_at_t</a> gradient_at, double *logdetce)</td></tr>
<tr class="separator:ab52d410e89a70e92c92362c32d135e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98fb20f9b43766d69f349eea85d1b7f0"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__part2d__fm__likelihood__state.html">_part2d_fm_likelihood_state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a98fb20f9b43766d69f349eea85d1b7f0">part2d_fm_likelihood_state_t</a></td></tr>
<tr class="separator:a98fb20f9b43766d69f349eea85d1b7f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75f540640c95db909125ed5c5eb7a1f3"><td class="memItemLeft" align="right" valign="top">typedef const double *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a>) (<a class="el" href="forwardmodel_8h.html#a98fb20f9b43766d69f349eea85d1b7f0">part2d_fm_likelihood_state_t</a> *state, double <a class="el" href="wellrng_8c.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>, double <a class="el" href="wellrng_8c.html#ac30de26db5f6d1c18c63913729adca7d">y</a>)</td></tr>
<tr class="separator:a75f540640c95db909125ed5c5eb7a1f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf0a94dea281d398d639a612dcc8197"><td class="memItemLeft" align="right" valign="top">typedef double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#accf0a94dea281d398d639a612dcc8197">part2d_fm_likelihood_t</a>) (void *userarg, int nglobalparameters, const double *global_parameters, <a class="el" href="forwardmodel_8h.html#a98fb20f9b43766d69f349eea85d1b7f0">part2d_fm_likelihood_state_t</a> *state, <a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a> value_at, <a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a> gradient_at, const <a class="el" href="bbox2d_8h.html#a1c61505f6f1c486a673ba4547602b9df">bbox2d_t</a> *bound)</td></tr>
<tr class="separator:accf0a94dea281d398d639a612dcc8197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a150ffbf03b04c658872258953574b7e5"><td class="memItemLeft" align="right" valign="top">typedef double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a150ffbf03b04c658872258953574b7e5">part2d_fm_hierarchical_likelihood_t</a>) (void *userarg, int nglobalparameters, const double *global_parameters, int hierarchical, int nhierarchicalparameters, const double *hierarchical_parameters, <a class="el" href="forwardmodel_8h.html#a98fb20f9b43766d69f349eea85d1b7f0">part2d_fm_likelihood_state_t</a> *state, <a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a> value_at, <a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a> gradient_at, const <a class="el" href="bbox2d_8h.html#a1c61505f6f1c486a673ba4547602b9df">bbox2d_t</a> *bound, double *logdetce)</td></tr>
<tr class="separator:a150ffbf03b04c658872258953574b7e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a65b1200fd2ef808c85b1915fa1413b58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultsetfm_8h.html#a6d6d798339572d2abc96b66e97ea62ac">resultsetfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a65b1200fd2ef808c85b1915fa1413b58">single_forwardmodel</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int <a class="el" href="rjmcmcf__mpi_8h.html#ad1c48db951dfa8787a94c0c56ae60e13">nparameters</a>, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *<a class="el" href="rjmcmcf__mpi_8h.html#af69ab156c03e104279d5e0cb70a0d4c4">parameters</a>, <a class="el" href="forwardmodel_8h.html#a094bcc9790c7865c0a721078d5334420">single_fm_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int <a class="el" href="rjmcmcf__mpi_8h.html#a30e374d8d017c0854f714c208aea6512">samples</a>, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, int results)</td></tr>
<tr class="memdesc:a65b1200fd2ef808c85b1915fa1413b58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single Partition Forward Model.  <a href="#a65b1200fd2ef808c85b1915fa1413b58">More...</a><br /></td></tr>
<tr class="separator:a65b1200fd2ef808c85b1915fa1413b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95b892df15e3e7b58497a68af64a7b0d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultsetfm_8h.html#a6d6d798339572d2abc96b66e97ea62ac">resultsetfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a95b892df15e3e7b58497a68af64a7b0d">single_forwardmodel_hierarchical</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int <a class="el" href="rjmcmcf__mpi_8h.html#ad1c48db951dfa8787a94c0c56ae60e13">nparameters</a>, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *<a class="el" href="rjmcmcf__mpi_8h.html#af69ab156c03e104279d5e0cb70a0d4c4">parameters</a>, int nhierarchicalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *hierarchicalparameters, <a class="el" href="forwardmodel_8h.html#a20a68d1e54609fed41954a0469e16d2c">single_fm_likelihood_hierarchical_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int nsamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, int results)</td></tr>
<tr class="memdesc:a95b892df15e3e7b58497a68af64a7b0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single Partition Forward Model with Hierarchical Noise.  <a href="#a95b892df15e3e7b58497a68af64a7b0d">More...</a><br /></td></tr>
<tr class="separator:a95b892df15e3e7b58497a68af64a7b0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a852beb6cfb6875927200fa90d6d60d6e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a852beb6cfb6875927200fa90d6d60d6e">part1d_forwardmodel</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int minpart, int maxpart, double minx, double maxx, int xsamples, int ysamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pd, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, <a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="memdesc:a852beb6cfb6875927200fa90d6d60d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">A partitioned 1d forward model.  <a href="#a852beb6cfb6875927200fa90d6d60d6e">More...</a><br /></td></tr>
<tr class="separator:a852beb6cfb6875927200fa90d6d60d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a267826c400d1ae8be3473c4bdc03e05b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a267826c400d1ae8be3473c4bdc03e05b">part1d_forwardmodel_hierarchical</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int minpart, int maxpart, double minx, double maxx, int xsamples, int ysamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pd, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, int nhierarchicalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *hierarchical_parameters, <a class="el" href="forwardmodel_8h.html#ab52d410e89a70e92c92362c32d135e45">part1d_fm_hierarchical_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="memdesc:a267826c400d1ae8be3473c4bdc03e05b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partitioned 1d forwardmodel with hierarchical parameters.  <a href="#a267826c400d1ae8be3473c4bdc03e05b">More...</a><br /></td></tr>
<tr class="separator:a267826c400d1ae8be3473c4bdc03e05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a736c12ab94ec4dd7e785baa8b028c6e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a736c12ab94ec4dd7e785baa8b028c6e6">part1d_forwardmodel_natural</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int minpart, int maxpart, double xmin, double xmax, int xsamples, int ysamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pd, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, <a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="memdesc:a736c12ab94ec4dd7e785baa8b028c6e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Natural partitioned forward model.  <a href="#a736c12ab94ec4dd7e785baa8b028c6e6">More...</a><br /></td></tr>
<tr class="separator:a736c12ab94ec4dd7e785baa8b028c6e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b46c9104fbbea5c119bc64e8f29190"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#ad6b46c9104fbbea5c119bc64e8f29190">part1d_forwardmodel_natural_hierarchical</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int minpart, int maxpart, double xmin, double xmax, int xsamples, int ysamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pd, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, int nhierarchicalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *hierarchical_parameters, <a class="el" href="forwardmodel_8h.html#ab52d410e89a70e92c92362c32d135e45">part1d_fm_hierarchical_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="memdesc:ad6b46c9104fbbea5c119bc64e8f29190"><td class="mdescLeft">&#160;</td><td class="mdescRight">Natural partitioned forward model with hierarchical parameters.  <a href="#ad6b46c9104fbbea5c119bc64e8f29190">More...</a><br /></td></tr>
<tr class="separator:ad6b46c9104fbbea5c119bc64e8f29190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c7c80dea7aefdbb9d8464633ef1277"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a16c7c80dea7aefdbb9d8464633ef1277">part1d_forwardmodel_natural_hierarchical_init</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int minpart, int maxpart, double xmin, double xmax, int xsamples, int ysamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pd, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, int nhierarchicalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *hierarchical_parameters, <a class="el" href="forwardmodel_8h.html#ab52d410e89a70e92c92362c32d135e45">part1d_fm_hierarchical_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="separator:a16c7c80dea7aefdbb9d8464633ef1277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a36aef21631f55a82528e22b81510f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a1a36aef21631f55a82528e22b81510f4">part1d_forwardmodel_natural_hierarchical_step</a> (void *state)</td></tr>
<tr class="separator:a1a36aef21631f55a82528e22b81510f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ccaf8818bd8d6cbf67253f181ed5949"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a7ccaf8818bd8d6cbf67253f181ed5949">part1d_forwardmodel_natural_hierarchical_finish</a> (void *state)</td></tr>
<tr class="separator:a7ccaf8818bd8d6cbf67253f181ed5949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa87c57a06b38510d6580c524dc31ba9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#aa87c57a06b38510d6580c524dc31ba9f">part1d_forwardmodel_zero_cubic</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int minpart, int maxpart, double xmin, double xmax, int xsamples, int ysamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pd, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, <a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="memdesc:aa87c57a06b38510d6580c524dc31ba9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cubic partitioned 1d forward model.  <a href="#aa87c57a06b38510d6580c524dc31ba9f">More...</a><br /></td></tr>
<tr class="separator:aa87c57a06b38510d6580c524dc31ba9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a30e27827e21f0906d74634c611cc54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset2dfm_8h.html#a24e8e056571b4ea36ad75ac908973669">resultset2dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a1a30e27827e21f0906d74634c611cc54">part2d_forwardmodel</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int thin, int minpart, int maxpart, int initpart, double minx, double maxx, double miny, double maxy, int xsamples, int ysamples, int zsamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pdx, double pdy, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, <a class="el" href="forwardmodel_8h.html#accf0a94dea281d398d639a612dcc8197">part2d_fm_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="memdesc:a1a30e27827e21f0906d74634c611cc54"><td class="mdescLeft">&#160;</td><td class="mdescRight">A partitioned 2d forward model.  <a href="#a1a30e27827e21f0906d74634c611cc54">More...</a><br /></td></tr>
<tr class="separator:a1a30e27827e21f0906d74634c611cc54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c79b83c0b31d163b242e9ef9bece73a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset2dfm_8h.html#a24e8e056571b4ea36ad75ac908973669">resultset2dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a0c79b83c0b31d163b242e9ef9bece73a">part2d_forwardmodel_restartable</a> (const char *model_file_in, const char *model_file_out, int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int thin, int minpart, int maxpart, int initpart, double xmin, double xmax, double ymin, double ymax, int xsamples, int ysamples, int zsamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pdx, double pdy, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, <a class="el" href="forwardmodel_8h.html#accf0a94dea281d398d639a612dcc8197">part2d_fm_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="separator:a0c79b83c0b31d163b242e9ef9bece73a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f812853c942aeb44dd57ce2823a8523"><td class="memItemLeft" align="right" valign="top"><a class="el" href="resultset2dfm_8h.html#a24e8e056571b4ea36ad75ac908973669">resultset2dfm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwardmodel_8h.html#a7f812853c942aeb44dd57ce2823a8523">part2d_forwardmodel_hierarchical</a> (int burnin, int <a class="el" href="rjmcmcf__mpi_8h.html#a1829e955eab35ef63200105c2de1ad94">total</a>, int thin, int minpart, int maxpart, int initpart, double minx, double maxx, double miny, double maxy, int xsamples, int ysamples, int zsamples, double <a class="el" href="rjmcmcf__mpi_8h.html#a5a7722a5cc210713ec1b3956fde06e70">credible_interval</a>, double pdx, double pdy, <a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a361f30102277b1d490d4edc190afccf6">random</a>, <a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a> <a class="el" href="rjmcmcf__mpi_8h.html#a6304ff7c79f9217c47a3373e460e3cfc">normal</a>, int nglobalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *global_parameters, int nlocalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *local_parameters, int nhierarchicalparameters, const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *hierarchical_parameters, <a class="el" href="forwardmodel_8h.html#a150ffbf03b04c658872258953574b7e5">part2d_fm_hierarchical_likelihood_t</a> lp, void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int results)</td></tr>
<tr class="memdesc:a7f812853c942aeb44dd57ce2823a8523"><td class="mdescLeft">&#160;</td><td class="mdescRight">A partitioned 2d forward model with hierarchical parameters.  <a href="#a7f812853c942aeb44dd57ce2823a8523">More...</a><br /></td></tr>
<tr class="separator:a7f812853c942aeb44dd57ce2823a8523"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simple Forward Model Routines. </p>
<p>The Forward Model routines allow the user to supply their own likelihood functions where a forward model is required to transform the data an error model other than uncorrelated gaussian noise is required.</p>
<p>These methods use callback functions to perform the forward model calculations. See the <a class="el" href="forwardmodel_8h.html#a094bcc9790c7865c0a721078d5334420">single_fm_likelihood_t</a>, <a class="el" href="forwardmodel_8h.html#a20a68d1e54609fed41954a0469e16d2c">single_fm_likelihood_hierarchical_t</a>, <a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a>, <a class="el" href="forwardmodel_8h.html#ab52d410e89a70e92c92362c32d135e45">part1d_fm_hierarchical_likelihood_t</a>, <a class="el" href="forwardmodel_8h.html#accf0a94dea281d398d639a612dcc8197">part2d_fm_likelihood_t</a> and <a class="el" href="forwardmodel_8h.html#a150ffbf03b04c658872258953574b7e5">part2d_fm_hierarchical_likelihood_t</a> types for the signatures of these functions.</p>
<p>The examples under the 1d/single/fm, 1d/partitioned/fm and 2d/partitioned/fm directories are instructive in the use of these methods. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a2026ad82eb4444663fea75d67fd619d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__part1d__fm__hierarchical__likelihood__state.html">_part1d_fm_hierarchical_likelihood_state</a> <a class="el" href="forwardmodel_8h.html#a2026ad82eb4444663fea75d67fd619d3">part1d_fm_hierarchical_likelihood_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab52d410e89a70e92c92362c32d135e45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double(* part1d_fm_hierarchical_likelihood_t) (void *userarg, int npartitions, const double *partition_boundaries, int nglobalparameters, const double *global_parameters, int hierarchical, int nhierarchicalparameters, const double *heirarchical_parameters, <a class="el" href="forwardmodel_8h.html#a2026ad82eb4444663fea75d67fd619d3">part1d_fm_hierarchical_likelihood_state_t</a> *state, <a class="el" href="forwardmodel_8h.html#a2b43e47273fdb108e220e5418db7496e">part1d_fm_hierarchical_value_at_t</a> value_at, <a class="el" href="forwardmodel_8h.html#a2b43e47273fdb108e220e5418db7496e">part1d_fm_hierarchical_value_at_t</a> gradient_at, double *logdetce)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2b43e47273fdb108e220e5418db7496e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef const double*(* part1d_fm_hierarchical_value_at_t) (<a class="el" href="forwardmodel_8h.html#a2026ad82eb4444663fea75d67fd619d3">part1d_fm_hierarchical_likelihood_state_t</a> *state, double <a class="el" href="wellrng_8c.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="1d_2partitioned_2fm_2regression_2regression_8c-example.html#a4">1d/partitioned/fm/regression/regression.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ab3cac657468dcba4666b4eb0e6014c97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__part1d__fm__likelihood__state.html">_part1d_fm_likelihood_state</a> <a class="el" href="forwardmodel_8h.html#ab3cac657468dcba4666b4eb0e6014c97">part1d_fm_likelihood_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a55c6095922233bbf09da18c6f3735642"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double(* part1d_fm_likelihood_t) (void *userarg, int npartitions, const double *partition_boundaries, int nglobalparameters, const double *global_parameters, <a class="el" href="forwardmodel_8h.html#ab3cac657468dcba4666b4eb0e6014c97">part1d_fm_likelihood_state_t</a> *state, <a class="el" href="forwardmodel_8h.html#ae0748a5b083292dc628303c679b25b2f">part1d_fm_value_at_t</a> value_at, <a class="el" href="forwardmodel_8h.html#ae0748a5b083292dc628303c679b25b2f">part1d_fm_value_at_t</a> gradient_at)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae0748a5b083292dc628303c679b25b2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef const double*(* part1d_fm_value_at_t) (<a class="el" href="forwardmodel_8h.html#ab3cac657468dcba4666b4eb0e6014c97">part1d_fm_likelihood_state_t</a> *state, double <a class="el" href="wellrng_8c.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="1d_2partitioned_2fm_2functionfit_2functionfit_8c-example.html#a3">1d/partitioned/fm/functionfit/functionfit.c</a>, and <a class="el" href="1d_2partitioned_2fm_2regression_2regression_8c-example.html#a6">1d/partitioned/fm/regression/regression.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a150ffbf03b04c658872258953574b7e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double(* part2d_fm_hierarchical_likelihood_t) (void *userarg, int nglobalparameters, const double *global_parameters, int hierarchical, int nhierarchicalparameters, const double *hierarchical_parameters, <a class="el" href="forwardmodel_8h.html#a98fb20f9b43766d69f349eea85d1b7f0">part2d_fm_likelihood_state_t</a> *state, <a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a> value_at, <a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a> gradient_at, const <a class="el" href="bbox2d_8h.html#a1c61505f6f1c486a673ba4547602b9df">bbox2d_t</a> *bound, double *logdetce)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a98fb20f9b43766d69f349eea85d1b7f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__part2d__fm__likelihood__state.html">_part2d_fm_likelihood_state</a> <a class="el" href="forwardmodel_8h.html#a98fb20f9b43766d69f349eea85d1b7f0">part2d_fm_likelihood_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="accf0a94dea281d398d639a612dcc8197"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double(* part2d_fm_likelihood_t) (void *userarg, int nglobalparameters, const double *global_parameters, <a class="el" href="forwardmodel_8h.html#a98fb20f9b43766d69f349eea85d1b7f0">part2d_fm_likelihood_state_t</a> *state, <a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a> value_at, <a class="el" href="forwardmodel_8h.html#a75f540640c95db909125ed5c5eb7a1f3">part2d_fm_value_at_t</a> gradient_at, const <a class="el" href="bbox2d_8h.html#a1c61505f6f1c486a673ba4547602b9df">bbox2d_t</a> *bound)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a75f540640c95db909125ed5c5eb7a1f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef const double*(* part2d_fm_value_at_t) (<a class="el" href="forwardmodel_8h.html#a98fb20f9b43766d69f349eea85d1b7f0">part2d_fm_likelihood_state_t</a> *state, double <a class="el" href="wellrng_8c.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>, double <a class="el" href="wellrng_8c.html#ac30de26db5f6d1c18c63913729adca7d">y</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="2d_2partitioned_2fm_2regression_2regression_8c-example.html#a1">2d/partitioned/fm/regression/regression.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a20a68d1e54609fed41954a0469e16d2c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double(* single_fm_likelihood_hierarchical_t) (void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int nvalues, const double *values, int hierarchical_proposal, int nhierarchicalvalues, const double *hierarchicalvalues, double *logdetCe)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a094bcc9790c7865c0a721078d5334420"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double(* single_fm_likelihood_t) (void *<a class="el" href="rjmcmcf__mpi_8h.html#ab68b3a27bfe943a73cf680c2e439e070">user_arg</a>, int n, const double *values)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a852beb6cfb6875927200fa90d6d60d6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a>* part1d_forwardmodel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A partitioned 1d forward model. </p>
<p>This method performs a transdimensional mcmc forward model with zero order fitting within each partition. For a detailed description of this method, see <b>[bodinThesis]</b>.</p>
<p>The return value calculated should be the negative log likelihood as in the <a class="el" href="forwardmodel_8h.html#a65b1200fd2ef808c85b1915fa1413b58" title="Single Partition Forward Model. ">single_forwardmodel</a> method which is essentially the weighted sum of square errors.</p>
<p>The callback function supplied to the lp parameter is where the forward model is implemented. This function must match the signature of the <a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a> type. The parameters passed to the this callback give you opaque access to the proposed model for which the log likelihood needs to be computed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">burnin</td><td>The number of burn in iterations. </td></tr>
    <tr><td class="paramname">total</td><td>The total number of iterations (must be greater than burnin). </td></tr>
    <tr><td class="paramname">minpart</td><td>The minimum number of partitions, this should be 2. </td></tr>
    <tr><td class="paramname">maxpart</td><td>The maximum number of partitions. </td></tr>
    <tr><td class="paramname">minx</td><td>The lower bound value of the x coordinate </td></tr>
    <tr><td class="paramname">maxx</td><td>The upper bound value of the x coordinate. </td></tr>
    <tr><td class="paramname">xsamples</td><td>When producing mean curves etc, the number of discretization steps used for constructing the curve. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">ysamples</td><td>Results such as median, mode, credible intervals are computed using a histogram of values, this parameter sets the number of bins for this histogram. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">credible_interval</td><td>The credible interval expressed as a percentage between 0 and 1. </td></tr>
    <tr><td class="paramname">pd</td><td>The standard deviation of the perturb partition boundary (move) step. </td></tr>
    <tr><td class="paramname">random</td><td>User supplied uniform random number generator. </td></tr>
    <tr><td class="paramname">normal</td><td>User supplied normal random number generator. </td></tr>
    <tr><td class="paramname">nglobalparameters</td><td>The number of global parameters. </td></tr>
    <tr><td class="paramname">global_parameters</td><td>An array of global parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nlocalparameters</td><td>The number of local parameters. </td></tr>
    <tr><td class="paramname">local_parameters</td><td>An array of local parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">lp</td><td>The hierarchical likelihood function. </td></tr>
    <tr><td class="paramname">user_arg</td><td>A pointer to user data that will be supplied to the likelihood function. </td></tr>
    <tr><td class="paramname">results</td><td>The results desired as a bitwise or'ing of <a class="el" href="resultset1dfm_8h.html#afc3b11f934a94a4c1e202e3c6bf776df">resultset1dfm_result_t</a> values.</td></tr>
  </table>
  </dd>
</dl>
<p>For an example of using this function, see the example 1d/single/fm/partitioned/functionfit/functionfit.c </p>

<p>References <a class="el" href="struct__rjmcmc__engine__cb.html#ab76b8decf72beb07f5cbd5354873c075">_rjmcmc_engine_cb::accept</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#aea2c810aeae4815b886e2252c9bca337">_rjmcmc_engine_cb::arg</a>, <a class="el" href="structpart1dfm.html#a8cfbc803c3312c6eb1d8f2a1da847bb6">part1dfm::cb</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#ad3f49710b8fbbe3214fb9bc834ab2d6a">_rjmcmc_engine_cb::compute_misfit</a>, <a class="el" href="structpart1dfm.html#ae8bf0f9687de2ce288255f721b688f99">part1dfm::current</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="structpart1dfm.html#a370fa519f6f7026f02b0d10e1323e865">part1dfm::global_parameters</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a57db290226797053fee2f8af0577aaa6">_rjmcmc_engine_cb::initialize_state</a>, <a class="el" href="structpart1dfm.html#af12252cf6083f8193d4559e5c52dff94">part1dfm::local_parameters</a>, <a class="el" href="structpart1dfm.html#a6ce4c88ae82b1dd307742d27ec27855e">part1dfm::lp</a>, <a class="el" href="structpart1dfm.html#ae2c83da1f9e4050b85dc759aa93473e8">part1dfm::maxpart</a>, <a class="el" href="structpart1dfm.html#a783b431fe34721327a67300da93cdd07">part1dfm::mf_global_parameters</a>, <a class="el" href="structpart1dfm.html#ada4048863eed80775717e783b8d02ec5">part1dfm::mf_gradients</a>, <a class="el" href="structpart1dfm.html#a795409d0548dcdc982e04d1c2fec1010">part1dfm::mf_partitions</a>, <a class="el" href="structpart1dfm.html#a0d02d19bc445e7edc2c9c8f189bc4fc7">part1dfm::mf_values</a>, <a class="el" href="structpart1dfm.html#a0b2fd8202f99a776de436a1e7b52fd50">part1dfm::minpart</a>, <a class="el" href="structpart1dfm.html#ad84d22cd023a1c92efb40dbcbbfd03c9">part1dfm::nglobalparameters</a>, <a class="el" href="structpart1dfm.html#a3fccfef80cd67db9f4d22877918ea347">part1dfm::nlocalparameters</a>, <a class="el" href="structpart1dfm.html#ad469a99c23e84b8a0bbdef538814c583">part1dfm::normal</a>, <a class="el" href="structpart1dfm.html#adab33948ead9e6b860f6c62fdf582bab">part1dfm::nprocesses</a>, <a class="el" href="part1d__forwardmodel_8h.html#a07f3922b42067c9cb736d872eea155c6afef56d7824f5040036f35403c2c7c611">PART1D_FM_ZERO</a>, <a class="el" href="part1d__forwardmodel_8c.html#afc6a92ec1df5959662ef07cd5f577fa1">part1d_forwardmodel_create()</a>, <a class="el" href="part1d__forwardmodel_8c.html#aaa6874e2f558de5044eae3cc461d6695">part1d_forwardmodel_destroy()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a69d829afbd1ad49c4bcc17727d5d8a67">_rjmcmc_engine_cb::perturb_process</a>, <a class="el" href="structpart1dfm.html#a4d304ab3156bf80a702193ce6dd87361">part1dfm::proddelta_l</a>, <a class="el" href="structpart1dfm.html#acbe95d1f9621f2ee6466e54205486e79">part1dfm::proposed</a>, <a class="el" href="structpart1dfm.html#a809000639489a661f35c6cd1151bb5e2">part1dfm::random</a>, <a class="el" href="structpart1dfm.html#ad28611315f278836b0b0a7ba25baa551">part1dfm::results</a>, <a class="el" href="resultset1dfm_8c.html#a39a17d736fa177fa5805d53b64580677">resultset1dfm_assemble_results()</a>, <a class="el" href="resultset1dfm_8c.html#a33d1fc4f39fcdfa93a00bacdefffc4ce">resultset1dfm_create()</a>, <a class="el" href="resultset1dfm_8c.html#ad8195d90d2d853e8019cc53cbf16a88e">resultset1dfm_fill_xcoord_vector()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a7b6fbeefa874d38a241b96e13ca13e96">rjmcmc_create_array_2d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a9bd41e7ba213670c727bfc0126348faa">rjmcmc_destroy_array_2d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a6a85b9af744cef99827ea3cc7aebfa3b">_rjmcmc_engine_cb::sample</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a7017792797b8ce47ed670044f1bc8a0d">_rjmcmc_engine_cb::select_process</a>, <a class="el" href="structpart1dfm.html#ab255e4bf81b324b1c1ace6a88921f05d">part1dfm::user_arg</a>, <a class="el" href="structpart1dfm.html#a43c76d5f2756aca4d037e8d1f06e454f">part1dfm::x</a>, <a class="el" href="structpart1dfm.html#a96ead395f5c9aee43780a0b3af23419c">part1dfm::xmax</a>, <a class="el" href="structpart1dfm.html#a4f2e23775e17a7de28e949745763af02">part1dfm::xmin</a>, <a class="el" href="structpart1dfm.html#a87a222abfa06dce76a4e7aadf2695f46">part1dfm::xsamples</a>, and <a class="el" href="structpart1dfm.html#a9b3c68d30d4e9f3e607dd6063f770b36">part1dfm::y</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#aa7d79eacccaac4d0770cd207b166dced">part1d_forwardmodel_f()</a>.</p>

</div>
</div>
<a class="anchor" id="a267826c400d1ae8be3473c4bdc03e05b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a>* part1d_forwardmodel_hierarchical </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nhierarchicalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>hierarchical_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#ab52d410e89a70e92c92362c32d135e45">part1d_fm_hierarchical_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Partitioned 1d forwardmodel with hierarchical parameters. </p>
<p>This method is the same as the <a class="el" href="forwardmodel_8h.html#a852beb6cfb6875927200fa90d6d60d6e" title="A partitioned 1d forward model. ">part1d_forwardmodel</a> except it also solves for hierarchical parameters that are used to construct the covariance matrix. See <b>[bodin2012A]</b> for an example application of hierarchical solving.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">burnin</td><td>The number of burn in iterations. </td></tr>
    <tr><td class="paramname">total</td><td>The total number of iterations (must be greater than burnin). </td></tr>
    <tr><td class="paramname">minpart</td><td>The minimum number of partitions, this should be 2. </td></tr>
    <tr><td class="paramname">maxpart</td><td>The maximum number of partitions. </td></tr>
    <tr><td class="paramname">minx</td><td>The lower bound value of the x coordinate </td></tr>
    <tr><td class="paramname">maxx</td><td>The upper bound value of the x coordinate. </td></tr>
    <tr><td class="paramname">xsamples</td><td>When producing mean curves etc, the number of discretization steps used for constructing the curve. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">ysamples</td><td>Results such as median, mode, credible intervals are computed using a histogram of values, this parameter sets the number of bins for this histogram. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">credible_interval</td><td>The credible interval expressed as a percentage between 0 and 1. </td></tr>
    <tr><td class="paramname">pd</td><td>The standard deviation of the perturb partition boundary (move) step. </td></tr>
    <tr><td class="paramname">random</td><td>User supplied uniform random number generator. </td></tr>
    <tr><td class="paramname">normal</td><td>User supplied normal random number generator. </td></tr>
    <tr><td class="paramname">nglobalparameters</td><td>The number of global parameters. </td></tr>
    <tr><td class="paramname">global_parameters</td><td>An array of global parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nlocalparameters</td><td>The number of local parameters. </td></tr>
    <tr><td class="paramname">local_parameters</td><td>An array of local parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nhierarchicalparameters</td><td>The number of hierarchical parameters. </td></tr>
    <tr><td class="paramname">hierarchical_parameters</td><td>An array of hierarchical parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">lp</td><td>The hierarchical likelihood function. </td></tr>
    <tr><td class="paramname">user_arg</td><td>A pointer to user data that will be supplied to the likelihood function. </td></tr>
    <tr><td class="paramname">results</td><td>The results desired as a bitwise or'ing of <a class="el" href="resultset1dfm_8h.html#afc3b11f934a94a4c1e202e3c6bf776df">resultset1dfm_result_t</a> values.</td></tr>
  </table>
  </dd>
</dl>
<p>For an example of using this function, see the example 1d/single/fm/partitioned/regression/regression.c </p>

<p>References <a class="el" href="struct__rjmcmc__engine__cb.html#ab76b8decf72beb07f5cbd5354873c075">_rjmcmc_engine_cb::accept</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#aea2c810aeae4815b886e2252c9bca337">_rjmcmc_engine_cb::arg</a>, <a class="el" href="structpart1dfm.html#a8cfbc803c3312c6eb1d8f2a1da847bb6">part1dfm::cb</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#ad3f49710b8fbbe3214fb9bc834ab2d6a">_rjmcmc_engine_cb::compute_misfit</a>, <a class="el" href="structpart1dfm.html#ae8bf0f9687de2ce288255f721b688f99">part1dfm::current</a>, <a class="el" href="structpart1dfm.html#aa8a7065c3963903b5e5ccc88489e6cb8">part1dfm::current_like</a>, <a class="el" href="structpart1dfm.html#aeb4eb5c676abbb3b7c7f58c5761e6e65">part1dfm::current_logdetce</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="structpart1dfm.html#a370fa519f6f7026f02b0d10e1323e865">part1dfm::global_parameters</a>, <a class="el" href="structpart1dfm.html#a3fcdeb881a4b7363a3a2f6a2463d71ec">part1dfm::hierarchical_parameters</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a57db290226797053fee2f8af0577aaa6">_rjmcmc_engine_cb::initialize_state</a>, <a class="el" href="structpart1dfm.html#af12252cf6083f8193d4559e5c52dff94">part1dfm::local_parameters</a>, <a class="el" href="structpart1dfm.html#a6ce4c88ae82b1dd307742d27ec27855e">part1dfm::lp</a>, <a class="el" href="structpart1dfm.html#ae2c83da1f9e4050b85dc759aa93473e8">part1dfm::maxpart</a>, <a class="el" href="structpart1dfm.html#a783b431fe34721327a67300da93cdd07">part1dfm::mf_global_parameters</a>, <a class="el" href="structpart1dfm.html#ada4048863eed80775717e783b8d02ec5">part1dfm::mf_gradients</a>, <a class="el" href="structpart1dfm.html#a795409d0548dcdc982e04d1c2fec1010">part1dfm::mf_partitions</a>, <a class="el" href="structpart1dfm.html#a0d02d19bc445e7edc2c9c8f189bc4fc7">part1dfm::mf_values</a>, <a class="el" href="structpart1dfm.html#a0b2fd8202f99a776de436a1e7b52fd50">part1dfm::minpart</a>, <a class="el" href="structpart1dfm.html#ad84d22cd023a1c92efb40dbcbbfd03c9">part1dfm::nglobalparameters</a>, <a class="el" href="structpart1dfm.html#a6e33f7b8588bf074fc851fddcd358d44">part1dfm::nhierarchicalparameters</a>, <a class="el" href="structpart1dfm.html#a3fccfef80cd67db9f4d22877918ea347">part1dfm::nlocalparameters</a>, <a class="el" href="structpart1dfm.html#ad469a99c23e84b8a0bbdef538814c583">part1dfm::normal</a>, <a class="el" href="forwardmodel__part1d__hierarchical_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba5db1a4a3a98b994052f5cbbd353efeed">NPROCESSES</a>, <a class="el" href="structpart1dfm.html#adab33948ead9e6b860f6c62fdf582bab">part1dfm::nprocesses</a>, <a class="el" href="forwardmodel__part1d__hierarchical_8c.html#a06fc87d81c62e9abb8790b6e5713c55baf8576a180583b4a0b40b3f0daa93a69a">NPROCESSES_NOGLOBAL</a>, <a class="el" href="part1d__forwardmodel_8h.html#a07f3922b42067c9cb736d872eea155c6afef56d7824f5040036f35403c2c7c611">PART1D_FM_ZERO</a>, <a class="el" href="part1d__forwardmodel_8c.html#afc6a92ec1df5959662ef07cd5f577fa1">part1d_forwardmodel_create()</a>, <a class="el" href="part1d__forwardmodel_8c.html#aaa6874e2f558de5044eae3cc461d6695">part1d_forwardmodel_destroy()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a69d829afbd1ad49c4bcc17727d5d8a67">_rjmcmc_engine_cb::perturb_process</a>, <a class="el" href="structpart1dfm.html#a4d304ab3156bf80a702193ce6dd87361">part1dfm::proddelta_l</a>, <a class="el" href="structpart1dfm.html#acbe95d1f9621f2ee6466e54205486e79">part1dfm::proposed</a>, <a class="el" href="structpart1dfm.html#ad995ce7712c33b1710c8e250221f62a0">part1dfm::proposed_like</a>, <a class="el" href="structpart1dfm.html#a2f03ff0e7c16c73a4e3c109e559ed9af">part1dfm::proposed_logdetce</a>, <a class="el" href="structpart1dfm.html#a809000639489a661f35c6cd1151bb5e2">part1dfm::random</a>, <a class="el" href="structpart1dfm.html#ad28611315f278836b0b0a7ba25baa551">part1dfm::results</a>, <a class="el" href="resultset1dfm_8c.html#a39a17d736fa177fa5805d53b64580677">resultset1dfm_assemble_results()</a>, <a class="el" href="resultset1dfm_8c.html#a33d1fc4f39fcdfa93a00bacdefffc4ce">resultset1dfm_create()</a>, <a class="el" href="resultset1dfm_8c.html#ad8195d90d2d853e8019cc53cbf16a88e">resultset1dfm_fill_xcoord_vector()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a7b6fbeefa874d38a241b96e13ca13e96">rjmcmc_create_array_2d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a9bd41e7ba213670c727bfc0126348faa">rjmcmc_destroy_array_2d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a6a85b9af744cef99827ea3cc7aebfa3b">_rjmcmc_engine_cb::sample</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a7017792797b8ce47ed670044f1bc8a0d">_rjmcmc_engine_cb::select_process</a>, <a class="el" href="structpart1dfm.html#ab255e4bf81b324b1c1ace6a88921f05d">part1dfm::user_arg</a>, <a class="el" href="structpart1dfm.html#a43c76d5f2756aca4d037e8d1f06e454f">part1dfm::x</a>, <a class="el" href="structpart1dfm.html#a96ead395f5c9aee43780a0b3af23419c">part1dfm::xmax</a>, <a class="el" href="structpart1dfm.html#a4f2e23775e17a7de28e949745763af02">part1dfm::xmin</a>, <a class="el" href="structpart1dfm.html#a87a222abfa06dce76a4e7aadf2695f46">part1dfm::xsamples</a>, and <a class="el" href="structpart1dfm.html#a9b3c68d30d4e9f3e607dd6063f770b36">part1dfm::y</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#ac92d1f381bc3bf8cafa2211606daa2d6">part1d_forwardmodel_hierarchical_f()</a>.</p>

</div>
</div>
<a class="anchor" id="a736c12ab94ec4dd7e785baa8b028c6e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a>* part1d_forwardmodel_natural </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Natural partitioned forward model. </p>
<p>This method is similar to the <a class="el" href="forwardmodel_8h.html#a852beb6cfb6875927200fa90d6d60d6e" title="A partitioned 1d forward model. ">part1d_forwardmodel</a> method except that instead of fitting zero order values in each partition, a continuous function is constructed using joined line segments between partition boundaries. For an example application of this method see <b>[hopcroft2007A]</b>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">burnin</td><td>The number of burn in iterations. </td></tr>
    <tr><td class="paramname">total</td><td>The total number of iterations (must be greater than burnin). </td></tr>
    <tr><td class="paramname">minpart</td><td>The minimum number of partitions, this should be 2. </td></tr>
    <tr><td class="paramname">maxpart</td><td>The maximum number of partitions. </td></tr>
    <tr><td class="paramname">minx</td><td>The lower bound value of the x coordinate </td></tr>
    <tr><td class="paramname">maxx</td><td>The upper bound value of the x coordinate. </td></tr>
    <tr><td class="paramname">xsamples</td><td>When producing mean curves etc, the number of discretization steps used for constructing the curve. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">ysamples</td><td>Results such as median, mode, credible intervals are computed using a histogram of values, this parameter sets the number of bins for this histogram. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">credible_interval</td><td>The credible interval expressed as a percentage between 0 and 1. </td></tr>
    <tr><td class="paramname">pd</td><td>The standard deviation of the perturb partition boundary (move) step. </td></tr>
    <tr><td class="paramname">random</td><td>User supplied uniform random number generator. </td></tr>
    <tr><td class="paramname">normal</td><td>User supplied normal random number generator. </td></tr>
    <tr><td class="paramname">nglobalparameters</td><td>The number of global parameters. </td></tr>
    <tr><td class="paramname">global_parameters</td><td>An array of global parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nlocalparameters</td><td>The number of local parameters. </td></tr>
    <tr><td class="paramname">local_parameters</td><td>An array of local parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">lp</td><td>The hierarchical likelihood function. </td></tr>
    <tr><td class="paramname">user_arg</td><td>A pointer to user data that will be supplied to the likelihood function. </td></tr>
    <tr><td class="paramname">results</td><td>The results desired as a bitwise or'ing of <a class="el" href="resultset1dfm_8h.html#afc3b11f934a94a4c1e202e3c6bf776df">resultset1dfm_result_t</a> values. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="struct__rjmcmc__engine__cb.html#ab76b8decf72beb07f5cbd5354873c075">_rjmcmc_engine_cb::accept</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#aea2c810aeae4815b886e2252c9bca337">_rjmcmc_engine_cb::arg</a>, <a class="el" href="structpart1dfm.html#a8cfbc803c3312c6eb1d8f2a1da847bb6">part1dfm::cb</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#ad3f49710b8fbbe3214fb9bc834ab2d6a">_rjmcmc_engine_cb::compute_misfit</a>, <a class="el" href="structpart1dfm.html#ae8bf0f9687de2ce288255f721b688f99">part1dfm::current</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="structpart1dfm.html#a370fa519f6f7026f02b0d10e1323e865">part1dfm::global_parameters</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a57db290226797053fee2f8af0577aaa6">_rjmcmc_engine_cb::initialize_state</a>, <a class="el" href="structpart1dfm.html#af12252cf6083f8193d4559e5c52dff94">part1dfm::local_parameters</a>, <a class="el" href="structpart1dfm.html#a6ce4c88ae82b1dd307742d27ec27855e">part1dfm::lp</a>, <a class="el" href="structpart1dfm.html#ae2c83da1f9e4050b85dc759aa93473e8">part1dfm::maxpart</a>, <a class="el" href="structpart1dfm.html#a783b431fe34721327a67300da93cdd07">part1dfm::mf_global_parameters</a>, <a class="el" href="structpart1dfm.html#ada4048863eed80775717e783b8d02ec5">part1dfm::mf_gradients</a>, <a class="el" href="structpart1dfm.html#a795409d0548dcdc982e04d1c2fec1010">part1dfm::mf_partitions</a>, <a class="el" href="structpart1dfm.html#a0d02d19bc445e7edc2c9c8f189bc4fc7">part1dfm::mf_values</a>, <a class="el" href="structpart1dfm.html#a0b2fd8202f99a776de436a1e7b52fd50">part1dfm::minpart</a>, <a class="el" href="structpart1dfm.html#ad84d22cd023a1c92efb40dbcbbfd03c9">part1dfm::nglobalparameters</a>, <a class="el" href="structpart1dfm.html#a3fccfef80cd67db9f4d22877918ea347">part1dfm::nlocalparameters</a>, <a class="el" href="structpart1dfm.html#ad469a99c23e84b8a0bbdef538814c583">part1dfm::normal</a>, <a class="el" href="structpart1dfm.html#adab33948ead9e6b860f6c62fdf582bab">part1dfm::nprocesses</a>, <a class="el" href="part1d__forwardmodel_8h.html#a07f3922b42067c9cb736d872eea155c6a9483ad23b93beabe1a25fe18fa8bc0c5">PART1D_FM_NATURAL</a>, <a class="el" href="part1d__forwardmodel_8c.html#afc6a92ec1df5959662ef07cd5f577fa1">part1d_forwardmodel_create()</a>, <a class="el" href="part1d__forwardmodel_8c.html#aaa6874e2f558de5044eae3cc461d6695">part1d_forwardmodel_destroy()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a69d829afbd1ad49c4bcc17727d5d8a67">_rjmcmc_engine_cb::perturb_process</a>, <a class="el" href="structpart1dfm.html#a4d304ab3156bf80a702193ce6dd87361">part1dfm::proddelta_l</a>, <a class="el" href="structpart1dfm.html#acbe95d1f9621f2ee6466e54205486e79">part1dfm::proposed</a>, <a class="el" href="structpart1dfm.html#a809000639489a661f35c6cd1151bb5e2">part1dfm::random</a>, <a class="el" href="structpart1dfm.html#ad28611315f278836b0b0a7ba25baa551">part1dfm::results</a>, <a class="el" href="resultset1dfm_8c.html#a39a17d736fa177fa5805d53b64580677">resultset1dfm_assemble_results()</a>, <a class="el" href="resultset1dfm_8c.html#a33d1fc4f39fcdfa93a00bacdefffc4ce">resultset1dfm_create()</a>, <a class="el" href="resultset1dfm_8c.html#ad8195d90d2d853e8019cc53cbf16a88e">resultset1dfm_fill_xcoord_vector()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a7b6fbeefa874d38a241b96e13ca13e96">rjmcmc_create_array_2d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a9bd41e7ba213670c727bfc0126348faa">rjmcmc_destroy_array_2d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a6a85b9af744cef99827ea3cc7aebfa3b">_rjmcmc_engine_cb::sample</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a7017792797b8ce47ed670044f1bc8a0d">_rjmcmc_engine_cb::select_process</a>, <a class="el" href="structpart1dfm.html#ab255e4bf81b324b1c1ace6a88921f05d">part1dfm::user_arg</a>, <a class="el" href="structpart1dfm.html#a43c76d5f2756aca4d037e8d1f06e454f">part1dfm::x</a>, <a class="el" href="structpart1dfm.html#a96ead395f5c9aee43780a0b3af23419c">part1dfm::xmax</a>, <a class="el" href="structpart1dfm.html#a4f2e23775e17a7de28e949745763af02">part1dfm::xmin</a>, <a class="el" href="structpart1dfm.html#a87a222abfa06dce76a4e7aadf2695f46">part1dfm::xsamples</a>, and <a class="el" href="structpart1dfm.html#a9b3c68d30d4e9f3e607dd6063f770b36">part1dfm::y</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#ab98dc69c670f8d947bddd88cc76ea33e">part1d_forwardmodel_natural_f()</a>.</p>

</div>
</div>
<a class="anchor" id="ad6b46c9104fbbea5c119bc64e8f29190"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a>* part1d_forwardmodel_natural_hierarchical </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nhierarchicalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>hierarchical_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#ab52d410e89a70e92c92362c32d135e45">part1d_fm_hierarchical_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Natural partitioned forward model with hierarchical parameters. </p>
<p>This method is the same as the <a class="el" href="forwardmodel_8h.html#a267826c400d1ae8be3473c4bdc03e05b" title="Partitioned 1d forwardmodel with hierarchical parameters. ">part1d_forwardmodel_hierarchical</a> except it uses joined line segments between partition boundaries rather than zero order fits within each partition to fit the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">burnin</td><td>The number of burn in iterations. </td></tr>
    <tr><td class="paramname">total</td><td>The total number of iterations (must be greater than burnin). </td></tr>
    <tr><td class="paramname">minpart</td><td>The minimum number of partitions, this should be 2. </td></tr>
    <tr><td class="paramname">maxpart</td><td>The maximum number of partitions. </td></tr>
    <tr><td class="paramname">minx</td><td>The lower bound value of the x coordinate </td></tr>
    <tr><td class="paramname">maxx</td><td>The upper bound value of the x coordinate. </td></tr>
    <tr><td class="paramname">xsamples</td><td>When producing mean curves etc, the number of discretization steps used for constructing the curve. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">ysamples</td><td>Results such as median, mode, credible intervals are computed using a histogram of values, this parameter sets the number of bins for this histogram. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">credible_interval</td><td>The credible interval expressed as a percentage between 0 and 1. </td></tr>
    <tr><td class="paramname">pd</td><td>The standard deviation of the perturb partition boundary (move) step. </td></tr>
    <tr><td class="paramname">random</td><td>User supplied uniform random number generator. </td></tr>
    <tr><td class="paramname">normal</td><td>User supplied normal random number generator. </td></tr>
    <tr><td class="paramname">nglobalparameters</td><td>The number of global parameters. </td></tr>
    <tr><td class="paramname">global_parameters</td><td>An array of global parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nlocalparameters</td><td>The number of local parameters. </td></tr>
    <tr><td class="paramname">local_parameters</td><td>An array of local parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nhierarchicalparameters</td><td>The number of hierarchical parameters. </td></tr>
    <tr><td class="paramname">hierarchical_parameters</td><td>An array of hierarchical parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">lp</td><td>The hierarchical likelihood function. </td></tr>
    <tr><td class="paramname">user_arg</td><td>A pointer to user data that will be supplied to the likelihood function. </td></tr>
    <tr><td class="paramname">results</td><td>The results desired as a bitwise or'ing of <a class="el" href="resultset1dfm_8h.html#afc3b11f934a94a4c1e202e3c6bf776df">resultset1dfm_result_t</a> values. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="struct__rjmcmc__engine__cb.html#ab76b8decf72beb07f5cbd5354873c075">_rjmcmc_engine_cb::accept</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#aea2c810aeae4815b886e2252c9bca337">_rjmcmc_engine_cb::arg</a>, <a class="el" href="structpart1dfm.html#a8cfbc803c3312c6eb1d8f2a1da847bb6">part1dfm::cb</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#ad3f49710b8fbbe3214fb9bc834ab2d6a">_rjmcmc_engine_cb::compute_misfit</a>, <a class="el" href="structpart1dfm.html#ae8bf0f9687de2ce288255f721b688f99">part1dfm::current</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="structpart1dfm.html#a370fa519f6f7026f02b0d10e1323e865">part1dfm::global_parameters</a>, <a class="el" href="structpart1dfm.html#a3fcdeb881a4b7363a3a2f6a2463d71ec">part1dfm::hierarchical_parameters</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a57db290226797053fee2f8af0577aaa6">_rjmcmc_engine_cb::initialize_state</a>, <a class="el" href="structpart1dfm.html#af12252cf6083f8193d4559e5c52dff94">part1dfm::local_parameters</a>, <a class="el" href="structpart1dfm.html#a6ce4c88ae82b1dd307742d27ec27855e">part1dfm::lp</a>, <a class="el" href="structpart1dfm.html#ae2c83da1f9e4050b85dc759aa93473e8">part1dfm::maxpart</a>, <a class="el" href="structpart1dfm.html#a783b431fe34721327a67300da93cdd07">part1dfm::mf_global_parameters</a>, <a class="el" href="structpart1dfm.html#ada4048863eed80775717e783b8d02ec5">part1dfm::mf_gradients</a>, <a class="el" href="structpart1dfm.html#a795409d0548dcdc982e04d1c2fec1010">part1dfm::mf_partitions</a>, <a class="el" href="structpart1dfm.html#a0d02d19bc445e7edc2c9c8f189bc4fc7">part1dfm::mf_values</a>, <a class="el" href="structpart1dfm.html#a0b2fd8202f99a776de436a1e7b52fd50">part1dfm::minpart</a>, <a class="el" href="structpart1dfm.html#ad84d22cd023a1c92efb40dbcbbfd03c9">part1dfm::nglobalparameters</a>, <a class="el" href="structpart1dfm.html#a6e33f7b8588bf074fc851fddcd358d44">part1dfm::nhierarchicalparameters</a>, <a class="el" href="structpart1dfm.html#a3fccfef80cd67db9f4d22877918ea347">part1dfm::nlocalparameters</a>, <a class="el" href="structpart1dfm.html#ad469a99c23e84b8a0bbdef538814c583">part1dfm::normal</a>, <a class="el" href="forwardmodel__part1d__hierarchical_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba5db1a4a3a98b994052f5cbbd353efeed">NPROCESSES</a>, <a class="el" href="structpart1dfm.html#adab33948ead9e6b860f6c62fdf582bab">part1dfm::nprocesses</a>, <a class="el" href="forwardmodel__part1d__hierarchical_8c.html#a06fc87d81c62e9abb8790b6e5713c55baf8576a180583b4a0b40b3f0daa93a69a">NPROCESSES_NOGLOBAL</a>, <a class="el" href="part1d__forwardmodel_8h.html#a07f3922b42067c9cb736d872eea155c6a9483ad23b93beabe1a25fe18fa8bc0c5">PART1D_FM_NATURAL</a>, <a class="el" href="part1d__forwardmodel_8c.html#afc6a92ec1df5959662ef07cd5f577fa1">part1d_forwardmodel_create()</a>, <a class="el" href="part1d__forwardmodel_8c.html#aaa6874e2f558de5044eae3cc461d6695">part1d_forwardmodel_destroy()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a69d829afbd1ad49c4bcc17727d5d8a67">_rjmcmc_engine_cb::perturb_process</a>, <a class="el" href="structpart1dfm.html#a4d304ab3156bf80a702193ce6dd87361">part1dfm::proddelta_l</a>, <a class="el" href="structpart1dfm.html#acbe95d1f9621f2ee6466e54205486e79">part1dfm::proposed</a>, <a class="el" href="structpart1dfm.html#a809000639489a661f35c6cd1151bb5e2">part1dfm::random</a>, <a class="el" href="structpart1dfm.html#ad28611315f278836b0b0a7ba25baa551">part1dfm::results</a>, <a class="el" href="resultset1dfm_8c.html#a39a17d736fa177fa5805d53b64580677">resultset1dfm_assemble_results()</a>, <a class="el" href="resultset1dfm_8c.html#a33d1fc4f39fcdfa93a00bacdefffc4ce">resultset1dfm_create()</a>, <a class="el" href="resultset1dfm_8c.html#ad8195d90d2d853e8019cc53cbf16a88e">resultset1dfm_fill_xcoord_vector()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a7b6fbeefa874d38a241b96e13ca13e96">rjmcmc_create_array_2d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a9bd41e7ba213670c727bfc0126348faa">rjmcmc_destroy_array_2d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a6a85b9af744cef99827ea3cc7aebfa3b">_rjmcmc_engine_cb::sample</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a7017792797b8ce47ed670044f1bc8a0d">_rjmcmc_engine_cb::select_process</a>, <a class="el" href="structpart1dfm.html#ab255e4bf81b324b1c1ace6a88921f05d">part1dfm::user_arg</a>, <a class="el" href="structpart1dfm.html#a43c76d5f2756aca4d037e8d1f06e454f">part1dfm::x</a>, <a class="el" href="structpart1dfm.html#a96ead395f5c9aee43780a0b3af23419c">part1dfm::xmax</a>, <a class="el" href="structpart1dfm.html#a4f2e23775e17a7de28e949745763af02">part1dfm::xmin</a>, <a class="el" href="structpart1dfm.html#a87a222abfa06dce76a4e7aadf2695f46">part1dfm::xsamples</a>, and <a class="el" href="structpart1dfm.html#a9b3c68d30d4e9f3e607dd6063f770b36">part1dfm::y</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#ad2e5cf51c798c7825cbf84381a44e007">part1d_forwardmodel_natural_hierarchical_f()</a>.</p>

</div>
</div>
<a class="anchor" id="a7ccaf8818bd8d6cbf67253f181ed5949"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a>* part1d_forwardmodel_natural_hierarchical_finish </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>References <a class="el" href="structpart1dfm.html#ae8bf0f9687de2ce288255f721b688f99">part1dfm::current</a>, <a class="el" href="structpart1dfm.html#a783b431fe34721327a67300da93cdd07">part1dfm::mf_global_parameters</a>, <a class="el" href="structpart1dfm.html#ada4048863eed80775717e783b8d02ec5">part1dfm::mf_gradients</a>, <a class="el" href="structpart1dfm.html#a795409d0548dcdc982e04d1c2fec1010">part1dfm::mf_partitions</a>, <a class="el" href="structpart1dfm.html#a0d02d19bc445e7edc2c9c8f189bc4fc7">part1dfm::mf_values</a>, <a class="el" href="structpart1dfm.html#a3fccfef80cd67db9f4d22877918ea347">part1dfm::nlocalparameters</a>, <a class="el" href="part1d__forwardmodel_8c.html#aaa6874e2f558de5044eae3cc461d6695">part1d_forwardmodel_destroy()</a>, <a class="el" href="structpart1dfm.html#acbe95d1f9621f2ee6466e54205486e79">part1dfm::proposed</a>, <a class="el" href="structpart1dfm.html#ad28611315f278836b0b0a7ba25baa551">part1dfm::results</a>, <a class="el" href="resultset1dfm_8c.html#a39a17d736fa177fa5805d53b64580677">resultset1dfm_assemble_results()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a9bd41e7ba213670c727bfc0126348faa">rjmcmc_destroy_array_2d()</a>, <a class="el" href="structpart1dfm.html#a43c76d5f2756aca4d037e8d1f06e454f">part1dfm::x</a>, and <a class="el" href="structpart1dfm.html#a9b3c68d30d4e9f3e607dd6063f770b36">part1dfm::y</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#a4a01e9c981ec15e99ac4cb7be6aa9763">part1d_forwardmodel_natural_hierarchical_finish_f()</a>.</p>

</div>
</div>
<a class="anchor" id="a16c7c80dea7aefdbb9d8464633ef1277"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* part1d_forwardmodel_natural_hierarchical_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nhierarchicalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>hierarchical_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#ab52d410e89a70e92c92362c32d135e45">part1d_fm_hierarchical_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>References <a class="el" href="struct__rjmcmc__engine__cb.html#ab76b8decf72beb07f5cbd5354873c075">_rjmcmc_engine_cb::accept</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#aea2c810aeae4815b886e2252c9bca337">_rjmcmc_engine_cb::arg</a>, <a class="el" href="structpart1dfm.html#a8cfbc803c3312c6eb1d8f2a1da847bb6">part1dfm::cb</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#ad3f49710b8fbbe3214fb9bc834ab2d6a">_rjmcmc_engine_cb::compute_misfit</a>, <a class="el" href="structpart1dfm.html#ae8bf0f9687de2ce288255f721b688f99">part1dfm::current</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="structpart1dfm.html#a370fa519f6f7026f02b0d10e1323e865">part1dfm::global_parameters</a>, <a class="el" href="structpart1dfm.html#a3fcdeb881a4b7363a3a2f6a2463d71ec">part1dfm::hierarchical_parameters</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a57db290226797053fee2f8af0577aaa6">_rjmcmc_engine_cb::initialize_state</a>, <a class="el" href="structpart1dfm.html#af12252cf6083f8193d4559e5c52dff94">part1dfm::local_parameters</a>, <a class="el" href="structpart1dfm.html#a6ce4c88ae82b1dd307742d27ec27855e">part1dfm::lp</a>, <a class="el" href="structpart1dfm.html#ae2c83da1f9e4050b85dc759aa93473e8">part1dfm::maxpart</a>, <a class="el" href="structpart1dfm.html#a783b431fe34721327a67300da93cdd07">part1dfm::mf_global_parameters</a>, <a class="el" href="structpart1dfm.html#ada4048863eed80775717e783b8d02ec5">part1dfm::mf_gradients</a>, <a class="el" href="structpart1dfm.html#a795409d0548dcdc982e04d1c2fec1010">part1dfm::mf_partitions</a>, <a class="el" href="structpart1dfm.html#a0d02d19bc445e7edc2c9c8f189bc4fc7">part1dfm::mf_values</a>, <a class="el" href="structpart1dfm.html#a0b2fd8202f99a776de436a1e7b52fd50">part1dfm::minpart</a>, <a class="el" href="structpart1dfm.html#ad84d22cd023a1c92efb40dbcbbfd03c9">part1dfm::nglobalparameters</a>, <a class="el" href="structpart1dfm.html#a6e33f7b8588bf074fc851fddcd358d44">part1dfm::nhierarchicalparameters</a>, <a class="el" href="structpart1dfm.html#a3fccfef80cd67db9f4d22877918ea347">part1dfm::nlocalparameters</a>, <a class="el" href="structpart1dfm.html#ad469a99c23e84b8a0bbdef538814c583">part1dfm::normal</a>, <a class="el" href="forwardmodel__part1d__hierarchical_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba5db1a4a3a98b994052f5cbbd353efeed">NPROCESSES</a>, <a class="el" href="structpart1dfm.html#adab33948ead9e6b860f6c62fdf582bab">part1dfm::nprocesses</a>, <a class="el" href="forwardmodel__part1d__hierarchical_8c.html#a06fc87d81c62e9abb8790b6e5713c55baf8576a180583b4a0b40b3f0daa93a69a">NPROCESSES_NOGLOBAL</a>, <a class="el" href="part1d__forwardmodel_8h.html#a07f3922b42067c9cb736d872eea155c6a9483ad23b93beabe1a25fe18fa8bc0c5">PART1D_FM_NATURAL</a>, <a class="el" href="part1d__forwardmodel_8c.html#afc6a92ec1df5959662ef07cd5f577fa1">part1d_forwardmodel_create()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a69d829afbd1ad49c4bcc17727d5d8a67">_rjmcmc_engine_cb::perturb_process</a>, <a class="el" href="structpart1dfm.html#a4d304ab3156bf80a702193ce6dd87361">part1dfm::proddelta_l</a>, <a class="el" href="structpart1dfm.html#acbe95d1f9621f2ee6466e54205486e79">part1dfm::proposed</a>, <a class="el" href="structpart1dfm.html#a809000639489a661f35c6cd1151bb5e2">part1dfm::random</a>, <a class="el" href="structpart1dfm.html#ad28611315f278836b0b0a7ba25baa551">part1dfm::results</a>, <a class="el" href="resultset1dfm_8c.html#a33d1fc4f39fcdfa93a00bacdefffc4ce">resultset1dfm_create()</a>, <a class="el" href="resultset1dfm_8c.html#ad8195d90d2d853e8019cc53cbf16a88e">resultset1dfm_fill_xcoord_vector()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a7b6fbeefa874d38a241b96e13ca13e96">rjmcmc_create_array_2d()</a>, <a class="el" href="engine_8c.html#a24e894e74681b6d7a1a8bd51101c991f">rjmcmc_engine_init()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a6a85b9af744cef99827ea3cc7aebfa3b">_rjmcmc_engine_cb::sample</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a7017792797b8ce47ed670044f1bc8a0d">_rjmcmc_engine_cb::select_process</a>, <a class="el" href="structpart1dfm.html#ab255e4bf81b324b1c1ace6a88921f05d">part1dfm::user_arg</a>, <a class="el" href="structpart1dfm.html#a43c76d5f2756aca4d037e8d1f06e454f">part1dfm::x</a>, <a class="el" href="structpart1dfm.html#a96ead395f5c9aee43780a0b3af23419c">part1dfm::xmax</a>, <a class="el" href="structpart1dfm.html#a4f2e23775e17a7de28e949745763af02">part1dfm::xmin</a>, <a class="el" href="structpart1dfm.html#a87a222abfa06dce76a4e7aadf2695f46">part1dfm::xsamples</a>, and <a class="el" href="structpart1dfm.html#a9b3c68d30d4e9f3e607dd6063f770b36">part1dfm::y</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#a2eddfed314f326dd0beec9ac6227a8ce">part1d_forwardmodel_natural_hierarchical_init_f()</a>.</p>

</div>
</div>
<a class="anchor" id="a1a36aef21631f55a82528e22b81510f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int part1d_forwardmodel_natural_hierarchical_step </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>References <a class="el" href="structpart1dfm.html#a8cfbc803c3312c6eb1d8f2a1da847bb6">part1dfm::cb</a>, and <a class="el" href="engine_8c.html#aee097319bf2edb220b198eaa6beb03e3">rjmcmc_engine_step()</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#a6b2e3a966500845564236448230e47a9">part1d_forwardmodel_natural_hierarchical_step_f()</a>.</p>

</div>
</div>
<a class="anchor" id="aa87c57a06b38510d6580c524dc31ba9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset1dfm_8h.html#a71ecc06ecc2e037129e00433985a6637">resultset1dfm_t</a>* part1d_forwardmodel_zero_cubic </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#a55c6095922233bbf09da18c6f3735642">part1d_fm_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cubic partitioned 1d forward model. </p>
<p>Experimental** code similar to <a class="el" href="forwardmodel_8h.html#a736c12ab94ec4dd7e785baa8b028c6e6" title="Natural partitioned forward model. ">part1d_forwardmodel_natural</a> except that instead of joining partitions with straight line segments, piecewise cubic segments are used with the gradients set to zero at the partition boundary. </p>

<p>References <a class="el" href="struct__rjmcmc__engine__cb.html#ab76b8decf72beb07f5cbd5354873c075">_rjmcmc_engine_cb::accept</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#aea2c810aeae4815b886e2252c9bca337">_rjmcmc_engine_cb::arg</a>, <a class="el" href="structpart1dfm.html#a8cfbc803c3312c6eb1d8f2a1da847bb6">part1dfm::cb</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#ad3f49710b8fbbe3214fb9bc834ab2d6a">_rjmcmc_engine_cb::compute_misfit</a>, <a class="el" href="structpart1dfm.html#ae8bf0f9687de2ce288255f721b688f99">part1dfm::current</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="structpart1dfm.html#a370fa519f6f7026f02b0d10e1323e865">part1dfm::global_parameters</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a57db290226797053fee2f8af0577aaa6">_rjmcmc_engine_cb::initialize_state</a>, <a class="el" href="structpart1dfm.html#af12252cf6083f8193d4559e5c52dff94">part1dfm::local_parameters</a>, <a class="el" href="structpart1dfm.html#a6ce4c88ae82b1dd307742d27ec27855e">part1dfm::lp</a>, <a class="el" href="structpart1dfm.html#ae2c83da1f9e4050b85dc759aa93473e8">part1dfm::maxpart</a>, <a class="el" href="structpart1dfm.html#a783b431fe34721327a67300da93cdd07">part1dfm::mf_global_parameters</a>, <a class="el" href="structpart1dfm.html#ada4048863eed80775717e783b8d02ec5">part1dfm::mf_gradients</a>, <a class="el" href="structpart1dfm.html#a795409d0548dcdc982e04d1c2fec1010">part1dfm::mf_partitions</a>, <a class="el" href="structpart1dfm.html#a0d02d19bc445e7edc2c9c8f189bc4fc7">part1dfm::mf_values</a>, <a class="el" href="structpart1dfm.html#a0b2fd8202f99a776de436a1e7b52fd50">part1dfm::minpart</a>, <a class="el" href="structpart1dfm.html#ad84d22cd023a1c92efb40dbcbbfd03c9">part1dfm::nglobalparameters</a>, <a class="el" href="structpart1dfm.html#a3fccfef80cd67db9f4d22877918ea347">part1dfm::nlocalparameters</a>, <a class="el" href="structpart1dfm.html#ad469a99c23e84b8a0bbdef538814c583">part1dfm::normal</a>, <a class="el" href="structpart1dfm.html#adab33948ead9e6b860f6c62fdf582bab">part1dfm::nprocesses</a>, <a class="el" href="part1d__forwardmodel_8h.html#a07f3922b42067c9cb736d872eea155c6a1c8e304ad9e3278ebb851f7a181d7bad">PART1D_FM_ZERO_CUBIC</a>, <a class="el" href="part1d__forwardmodel_8c.html#afc6a92ec1df5959662ef07cd5f577fa1">part1d_forwardmodel_create()</a>, <a class="el" href="part1d__forwardmodel_8c.html#aaa6874e2f558de5044eae3cc461d6695">part1d_forwardmodel_destroy()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a69d829afbd1ad49c4bcc17727d5d8a67">_rjmcmc_engine_cb::perturb_process</a>, <a class="el" href="structpart1dfm.html#a4d304ab3156bf80a702193ce6dd87361">part1dfm::proddelta_l</a>, <a class="el" href="structpart1dfm.html#acbe95d1f9621f2ee6466e54205486e79">part1dfm::proposed</a>, <a class="el" href="structpart1dfm.html#a809000639489a661f35c6cd1151bb5e2">part1dfm::random</a>, <a class="el" href="structpart1dfm.html#ad28611315f278836b0b0a7ba25baa551">part1dfm::results</a>, <a class="el" href="resultset1dfm_8c.html#a39a17d736fa177fa5805d53b64580677">resultset1dfm_assemble_results()</a>, <a class="el" href="resultset1dfm_8c.html#a33d1fc4f39fcdfa93a00bacdefffc4ce">resultset1dfm_create()</a>, <a class="el" href="resultset1dfm_8c.html#ad8195d90d2d853e8019cc53cbf16a88e">resultset1dfm_fill_xcoord_vector()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a7b6fbeefa874d38a241b96e13ca13e96">rjmcmc_create_array_2d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a9bd41e7ba213670c727bfc0126348faa">rjmcmc_destroy_array_2d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a6a85b9af744cef99827ea3cc7aebfa3b">_rjmcmc_engine_cb::sample</a>, <a class="el" href="struct__rjmcmc__engine__cb.html#a7017792797b8ce47ed670044f1bc8a0d">_rjmcmc_engine_cb::select_process</a>, <a class="el" href="structpart1dfm.html#ab255e4bf81b324b1c1ace6a88921f05d">part1dfm::user_arg</a>, <a class="el" href="structpart1dfm.html#a43c76d5f2756aca4d037e8d1f06e454f">part1dfm::x</a>, <a class="el" href="structpart1dfm.html#a96ead395f5c9aee43780a0b3af23419c">part1dfm::xmax</a>, <a class="el" href="structpart1dfm.html#a4f2e23775e17a7de28e949745763af02">part1dfm::xmin</a>, <a class="el" href="structpart1dfm.html#a87a222abfa06dce76a4e7aadf2695f46">part1dfm::xsamples</a>, and <a class="el" href="structpart1dfm.html#a9b3c68d30d4e9f3e607dd6063f770b36">part1dfm::y</a>.</p>

</div>
</div>
<a class="anchor" id="a1a30e27827e21f0906d74634c611cc54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset2dfm_8h.html#a24e8e056571b4ea36ad75ac908973669">resultset2dfm_t</a>* part2d_forwardmodel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>initpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>miny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>zsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pdy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#accf0a94dea281d398d639a612dcc8197">part2d_fm_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A partitioned 2d forward model. </p>
<p>This method performs a transdimensional mcmc forward model with zero order fitting within each partition. In the 2d case, the partitions are defined as voronoi cells. For a detailed description of this method, see <b>[bodinThesis]</b>.</p>
<p>The return value calculated should be the negative log likelihood as in the <a class="el" href="forwardmodel_8h.html#a65b1200fd2ef808c85b1915fa1413b58" title="Single Partition Forward Model. ">single_forwardmodel</a> method which is essentially the weighted sum of square errors.</p>
<p>The callback function supplied to the lp parameter is where the forward model is implemented. This function must match the signature of the <a class="el" href="forwardmodel_8h.html#accf0a94dea281d398d639a612dcc8197">part2d_fm_likelihood_t</a> type. The parameters passed to the this callback give you opaque access to the proposed model for which the log likelihood needs to be computed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">burnin</td><td>The number of burn in iterations. </td></tr>
    <tr><td class="paramname">total</td><td>The total number of iterations (must be greater than burnin). </td></tr>
    <tr><td class="paramname">minpart</td><td>The minimum number of partitions, this should be 2. </td></tr>
    <tr><td class="paramname">maxpart</td><td>The maximum number of partitions. </td></tr>
    <tr><td class="paramname">initpart</td><td>The initial number of partitions. </td></tr>
    <tr><td class="paramname">minx</td><td>The lower bound value of the x coordinate </td></tr>
    <tr><td class="paramname">maxx</td><td>The upper bound value of the x coordinate. </td></tr>
    <tr><td class="paramname">miny</td><td>The lower bound value of the y coordinate </td></tr>
    <tr><td class="paramname">maxy</td><td>The upper bound value of the y coordinate. </td></tr>
    <tr><td class="paramname">xsamples</td><td>When producing mean curves etc, the number of discretization steps used for constructing the curve. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">ysamples</td><td>When producing mean curves etc, the number of discretization steps used for constructing the curve. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">zsamples</td><td>Results such as median, mode, credible intervals are computed using a histogram of values, this parameter sets the number of bins for this histogram. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">credible_interval</td><td>The credible interval expressed as a percentage between 0 and 1. </td></tr>
    <tr><td class="paramname">pdx</td><td>The standard deviation of the perturb partition boundary (move) step in the x direction. </td></tr>
    <tr><td class="paramname">pdy</td><td>The standard deviation of the perturb partition boundary (move) step in the y direction. </td></tr>
    <tr><td class="paramname">random</td><td>User supplied uniform random number generator. </td></tr>
    <tr><td class="paramname">normal</td><td>User supplied normal random number generator. </td></tr>
    <tr><td class="paramname">nglobalparameters</td><td>The number of global parameters. </td></tr>
    <tr><td class="paramname">global_parameters</td><td>An array of global parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nlocalparameters</td><td>The number of local parameters. </td></tr>
    <tr><td class="paramname">local_parameters</td><td>An array of local parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">lp</td><td>The likelihood function. </td></tr>
    <tr><td class="paramname">user_arg</td><td>A pointer to user data that will be supplied to the likelihood function. </td></tr>
    <tr><td class="paramname">results</td><td>The results desired as a bitwise or'ing of <a class="el" href="resultset1dfm_8h.html#afc3b11f934a94a4c1e202e3c6bf776df">resultset1dfm_result_t</a> values.</td></tr>
  </table>
  </dd>
</dl>
<p>For an example of using this function, see the example 2d/partitioned/fm/regression/regression.h </p>

<p>References <a class="el" href="forwardmodel__part2d_8c.html#adf764cbdea00d65edcd07bb9953ad2b7a5db1a4a3a98b994052f5cbbd353efeed">NPROCESSES</a>, <a class="el" href="structpart2dfm.html#a9d5bf1d22e9b4ef82a99c9ddf819f442">part2dfm::nprocesses</a>, <a class="el" href="forwardmodel__part2d_8c.html#adf764cbdea00d65edcd07bb9953ad2b7af8576a180583b4a0b40b3f0daa93a69a">NPROCESSES_NOGLOBAL</a>, <a class="el" href="structpart2dfm.html#a8dbbf73b3c5e1d02ab42922c72a5f804">part2dfm::results</a>, <a class="el" href="resultset2dfm_8c.html#af8cbc8338db7900c1d7445199e6d4226">resultset2dfm_assemble_results()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, and <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#abae158f7f965c153f29a3f177b2bcc4b">part2d_forwardmodel_f()</a>.</p>

</div>
</div>
<a class="anchor" id="a7f812853c942aeb44dd57ce2823a8523"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset2dfm_8h.html#a24e8e056571b4ea36ad75ac908973669">resultset2dfm_t</a>* part2d_forwardmodel_hierarchical </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>initpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>miny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>zsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pdy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nhierarchicalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>hierarchical_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#a150ffbf03b04c658872258953574b7e5">part2d_fm_hierarchical_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A partitioned 2d forward model with hierarchical parameters. </p>
<p>This method is the same as the <a class="el" href="forwardmodel_8h.html#a1a30e27827e21f0906d74634c611cc54" title="A partitioned 2d forward model. ">part2d_forwardmodel</a> method except it also solves for hierarchical parameters that are used to construct the covariance matrix.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">burnin</td><td>The number of burn in iterations. </td></tr>
    <tr><td class="paramname">total</td><td>The total number of iterations (must be greater than burnin). </td></tr>
    <tr><td class="paramname">thin</td><td>The number of samples to skip when averaging (0 means none). </td></tr>
    <tr><td class="paramname">minpart</td><td>The minimum number of partitions, this should be 2. </td></tr>
    <tr><td class="paramname">maxpart</td><td>The maximum number of partitions. </td></tr>
    <tr><td class="paramname">initpart</td><td>The initial number of partitions. </td></tr>
    <tr><td class="paramname">minx</td><td>The lower bound value of the x coordinate </td></tr>
    <tr><td class="paramname">maxx</td><td>The upper bound value of the x coordinate. </td></tr>
    <tr><td class="paramname">miny</td><td>The lower bound value of the y coordinate </td></tr>
    <tr><td class="paramname">maxy</td><td>The upper bound value of the y coordinate. </td></tr>
    <tr><td class="paramname">xsamples</td><td>When producing mean curves etc, the number of discretization steps used for constructing the curve. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">ysamples</td><td>When producing mean curves etc, the number of discretization steps used for constructing the curve. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">zsamples</td><td>Results such as median, mode, credible intervals are computed using a histogram of values, this parameter sets the number of bins for this histogram. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">credible_interval</td><td>The credible interval expressed as a percentage between 0 and 1. </td></tr>
    <tr><td class="paramname">pdx</td><td>The standard deviation of the perturb partition boundary (move) step in the x direction. </td></tr>
    <tr><td class="paramname">pdy</td><td>The standard deviation of the perturb partition boundary (move) step in the y direction. </td></tr>
    <tr><td class="paramname">random</td><td>User supplied uniform random number generator. </td></tr>
    <tr><td class="paramname">normal</td><td>User supplied normal random number generator. </td></tr>
    <tr><td class="paramname">nglobalparameters</td><td>The number of global parameters. </td></tr>
    <tr><td class="paramname">global_parameters</td><td>An array of global parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nlocalparameters</td><td>The number of local parameters. </td></tr>
    <tr><td class="paramname">local_parameters</td><td>An array of local parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">nhierarchicalparameters</td><td>The number of hierarchical parameters. </td></tr>
    <tr><td class="paramname">hierarchical_parameters</td><td>An array of hierarchical parameters (their min, max and perturbation standard deviations). </td></tr>
    <tr><td class="paramname">lp</td><td>The likelihood function. </td></tr>
    <tr><td class="paramname">user_arg</td><td>A pointer to user data that will be supplied to the likelihood function. </td></tr>
    <tr><td class="paramname">results</td><td>The results desired as a bitwise or'ing of <a class="el" href="resultset1dfm_8h.html#afc3b11f934a94a4c1e202e3c6bf776df">resultset1dfm_result_t</a> values.</td></tr>
  </table>
  </dd>
</dl>
<p>For an example of using this function, see the example 2d/partitioned/fm/regression/regression.h </p>

<p>References <a class="el" href="structpart2dfm.html#ac122d0a6bd19305b1cc5f5b4c90664e3">part2dfm::bound</a>, <a class="el" href="structpart2dfm.html#ac5b024b70caf5a93dfe11c68e4276d91">part2dfm::current</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="structpart2dfm.html#afa1305d51cc45376446343fb6451d29f">part2dfm::global_parameters</a>, <a class="el" href="structpart2dfm.html#ab229f71a3a8bcf91e167836bb6cfe563">part2dfm::hierarchical_parameters</a>, <a class="el" href="structpart2dfm.html#abbefe668a58ae58f174039986929d790">part2dfm::initpart</a>, <a class="el" href="structpart2dfm.html#a74ce0287c6c2cea1fb4b4e8bf310392f">part2dfm::local_parameters</a>, <a class="el" href="structpart2dfm.html#a01e70c10872c02060c6d947d7e018be3">part2dfm::lp</a>, <a class="el" href="structpart2dfm.html#a4bf2b8b0f9a31d52a4640b5d9e0154ab">part2dfm::maxpart</a>, <a class="el" href="structpart2dfm.html#a3f37e5875df194098a83a1013b2c28a7">part2dfm::mf_gradients</a>, <a class="el" href="structpart2dfm.html#a98e449e722a9d18c02102c74f5a02149">part2dfm::mf_values</a>, <a class="el" href="structpart2dfm.html#aaab4cc956caa7ed50e9ceca65c18ee74">part2dfm::minpart</a>, <a class="el" href="structpart2dfm.html#a88681cdaf686ff60bd2f7b1313cc089f">part2dfm::nglobalparameters</a>, <a class="el" href="structpart2dfm.html#a148a67222a4101bd9172e9399246c0f8">part2dfm::nhierarchicalparameters</a>, <a class="el" href="structpart2dfm.html#a0142966417b347b4ca7092912355ff8b">part2dfm::nlocalparameters</a>, <a class="el" href="structpart2dfm.html#ad29ffc1189a4cad01a99f50fef2bf0ba">part2dfm::normal</a>, <a class="el" href="forwardmodel__part2d__hierarchical_8c.html#a99fb83031ce9923c84392b4e92f956b5a5db1a4a3a98b994052f5cbbd353efeed">NPROCESSES</a>, <a class="el" href="structpart2dfm.html#a9d5bf1d22e9b4ef82a99c9ddf819f442">part2dfm::nprocesses</a>, <a class="el" href="forwardmodel__part2d__hierarchical_8c.html#a99fb83031ce9923c84392b4e92f956b5af8576a180583b4a0b40b3f0daa93a69a">NPROCESSES_NOGLOBAL</a>, <a class="el" href="part2d__forwardmodel_8h.html#aec5ec1239a93116e1d2ae34957781f77a152f8a4e5490ec6c76b3bbb2f307483e">PART2D_FM_ZERO</a>, <a class="el" href="part2d__forwardmodel_8c.html#ad48ca873e5aa0e5298dd7b3521dd358f">part2d_forwardmodel_create()</a>, <a class="el" href="part2d__forwardmodel_8c.html#ad0a5fd932fccf3e3ad60f59b8b3dd538">part2d_forwardmodel_destroy()</a>, <a class="el" href="structpart2dfm.html#a9bfafdf80c5638f7b413108129a968d7">part2dfm::proddelta_l</a>, <a class="el" href="structpart2dfm.html#a1d002ed5bc6e090de2aed680a1596d1f">part2dfm::proposed</a>, <a class="el" href="structpart2dfm.html#a4f3b1d16c58223eb6024decaf98b9e36">part2dfm::random</a>, <a class="el" href="structpart2dfm.html#a8dbbf73b3c5e1d02ab42922c72a5f804">part2dfm::results</a>, <a class="el" href="resultset2dfm_8c.html#af8cbc8338db7900c1d7445199e6d4226">resultset2dfm_assemble_results()</a>, <a class="el" href="resultset2dfm_8c.html#a2ad369a3845c4ffc468b1e945d01ca00">resultset2dfm_create()</a>, <a class="el" href="resultset2dfm_8c.html#a811a2ce18d80b60dc602da4ce5d586c5">resultset2dfm_fill_xcoord_vector()</a>, <a class="el" href="resultset2dfm_8c.html#ae98a6b9d97dba88d386dba86a9fa1baf">resultset2dfm_fill_ycoord_vector()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a97ae799394e9a78b0d6f2eacc3337a27">rjmcmc_create_array_3d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a6f7290148ca082a17cac7b163e06496e">rjmcmc_destroy_array_3d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="structpart2dfm.html#a95b6c3d5b74b4597308839c6a6ffbea9">part2dfm::user_arg</a>, <a class="el" href="structpart2dfm.html#a7c8db002ece90497df8ae33cc33e7893">part2dfm::x</a>, <a class="el" href="structbbox2d.html#a1bd0acf6ace939571bf8711ebadd761e">bbox2d::xmax</a>, <a class="el" href="structbbox2d.html#ab1e3c3b237d5a3b1290607bb0fa67b86">bbox2d::xmin</a>, <a class="el" href="structpart2dfm.html#a6ddf3a619abe1c9eba2c8d783661829f">part2dfm::xsamples</a>, <a class="el" href="structpart2dfm.html#a010d561ad03fa50c4b4a15046268fbef">part2dfm::y</a>, <a class="el" href="structbbox2d.html#a40b610959dbfc797e21296a0dffeaaff">bbox2d::ymax</a>, <a class="el" href="structbbox2d.html#aad7439c67803e5ecc96a70ed0cfd1a28">bbox2d::ymin</a>, <a class="el" href="structpart2dfm.html#a734cb1341cafde5f78fe5703b0ccc431">part2dfm::ysamples</a>, and <a class="el" href="structpart2dfm.html#a73279bf493761b119d0eef31b35e4ebd">part2dfm::z</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#a4b79abefd756080588bec3912c650f97">part2d_forwardmodel_hierarchical_f()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c79b83c0b31d163b242e9ef9bece73a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultset2dfm_8h.html#a24e8e056571b4ea36ad75ac908973669">resultset2dfm_t</a>* part2d_forwardmodel_restartable </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>model_file_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>model_file_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>initpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ymax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>zsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pdy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nglobalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>global_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlocalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>local_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#accf0a94dea281d398d639a612dcc8197">part2d_fm_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>References <a class="el" href="structpart2dfm.html#ac122d0a6bd19305b1cc5f5b4c90664e3">part2dfm::bound</a>, <a class="el" href="structpart2dfm.html#af6218a03077acb5ab203ebc433d9dff3">part2dfm::checkpoint_interval</a>, <a class="el" href="structpart2dfm.html#ae70d8586e036ef85214eec8ef68ed857">part2dfm::checkpoint_prefix</a>, <a class="el" href="structpart2dfm.html#ac5b024b70caf5a93dfe11c68e4276d91">part2dfm::current</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="structpart2dfm.html#afa1305d51cc45376446343fb6451d29f">part2dfm::global_parameters</a>, <a class="el" href="structpart2dfm.html#abbefe668a58ae58f174039986929d790">part2dfm::initpart</a>, <a class="el" href="structpart2dfm.html#a74ce0287c6c2cea1fb4b4e8bf310392f">part2dfm::local_parameters</a>, <a class="el" href="structpart2dfm.html#a01e70c10872c02060c6d947d7e018be3">part2dfm::lp</a>, <a class="el" href="structpart2dfm.html#a4bf2b8b0f9a31d52a4640b5d9e0154ab">part2dfm::maxpart</a>, <a class="el" href="structpart2dfm.html#a3f37e5875df194098a83a1013b2c28a7">part2dfm::mf_gradients</a>, <a class="el" href="structpart2dfm.html#a98e449e722a9d18c02102c74f5a02149">part2dfm::mf_values</a>, <a class="el" href="structpart2dfm.html#aaab4cc956caa7ed50e9ceca65c18ee74">part2dfm::minpart</a>, <a class="el" href="structpart2dfm.html#aefe781530739011dadc002397e4258b8">part2dfm::mpirank</a>, <a class="el" href="structpart2dfm.html#a88681cdaf686ff60bd2f7b1313cc089f">part2dfm::nglobalparameters</a>, <a class="el" href="structpart2dfm.html#a0142966417b347b4ca7092912355ff8b">part2dfm::nlocalparameters</a>, <a class="el" href="structpart2dfm.html#ad29ffc1189a4cad01a99f50fef2bf0ba">part2dfm::normal</a>, <a class="el" href="forwardmodel__part2d_8c.html#adf764cbdea00d65edcd07bb9953ad2b7a5db1a4a3a98b994052f5cbbd353efeed">NPROCESSES</a>, <a class="el" href="structpart2dfm.html#a9d5bf1d22e9b4ef82a99c9ddf819f442">part2dfm::nprocesses</a>, <a class="el" href="forwardmodel__part2d_8c.html#adf764cbdea00d65edcd07bb9953ad2b7af8576a180583b4a0b40b3f0daa93a69a">NPROCESSES_NOGLOBAL</a>, <a class="el" href="part2d__forwardmodel_8h.html#aec5ec1239a93116e1d2ae34957781f77a152f8a4e5490ec6c76b3bbb2f307483e">PART2D_FM_ZERO</a>, <a class="el" href="part2d__forwardmodel_8c.html#ad48ca873e5aa0e5298dd7b3521dd358f">part2d_forwardmodel_create()</a>, <a class="el" href="part2d__forwardmodel_8c.html#ad0a5fd932fccf3e3ad60f59b8b3dd538">part2d_forwardmodel_destroy()</a>, <a class="el" href="part2d__forwardmodel_8c.html#a41a3ec0b0861f68c40d47f3950964e74">part2d_forwardmodel_load()</a>, <a class="el" href="part2d__forwardmodel_8c.html#a8db4e8ad8e1d827a5dfb5dc1e4b7056f">part2d_forwardmodel_save()</a>, <a class="el" href="structpart2dfm.html#a9bfafdf80c5638f7b413108129a968d7">part2dfm::proddelta_l</a>, <a class="el" href="structpart2dfm.html#a1d002ed5bc6e090de2aed680a1596d1f">part2dfm::proposed</a>, <a class="el" href="structpart2dfm.html#a4f3b1d16c58223eb6024decaf98b9e36">part2dfm::random</a>, <a class="el" href="structpart2dfm.html#a8dbbf73b3c5e1d02ab42922c72a5f804">part2dfm::results</a>, <a class="el" href="resultset2dfm_8c.html#af8cbc8338db7900c1d7445199e6d4226">resultset2dfm_assemble_results()</a>, <a class="el" href="resultset2dfm_8c.html#a2ad369a3845c4ffc468b1e945d01ca00">resultset2dfm_create()</a>, <a class="el" href="resultset2dfm_8c.html#a811a2ce18d80b60dc602da4ce5d586c5">resultset2dfm_fill_xcoord_vector()</a>, <a class="el" href="resultset2dfm_8c.html#ae98a6b9d97dba88d386dba86a9fa1baf">resultset2dfm_fill_ycoord_vector()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a97ae799394e9a78b0d6f2eacc3337a27">rjmcmc_create_array_3d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a6f7290148ca082a17cac7b163e06496e">rjmcmc_destroy_array_3d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="structpart2dfm.html#a95b6c3d5b74b4597308839c6a6ffbea9">part2dfm::user_arg</a>, <a class="el" href="structpart2dfm.html#a7c8db002ece90497df8ae33cc33e7893">part2dfm::x</a>, <a class="el" href="structbbox2d.html#a1bd0acf6ace939571bf8711ebadd761e">bbox2d::xmax</a>, <a class="el" href="structbbox2d.html#ab1e3c3b237d5a3b1290607bb0fa67b86">bbox2d::xmin</a>, <a class="el" href="structpart2dfm.html#a6ddf3a619abe1c9eba2c8d783661829f">part2dfm::xsamples</a>, <a class="el" href="structpart2dfm.html#a010d561ad03fa50c4b4a15046268fbef">part2dfm::y</a>, <a class="el" href="structbbox2d.html#a40b610959dbfc797e21296a0dffeaaff">bbox2d::ymax</a>, <a class="el" href="structbbox2d.html#aad7439c67803e5ecc96a70ed0cfd1a28">bbox2d::ymin</a>, <a class="el" href="structpart2dfm.html#a734cb1341cafde5f78fe5703b0ccc431">part2dfm::ysamples</a>, and <a class="el" href="structpart2dfm.html#a73279bf493761b119d0eef31b35e4ebd">part2dfm::z</a>.</p>

</div>
</div>
<a class="anchor" id="a65b1200fd2ef808c85b1915fa1413b58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultsetfm_8h.html#a6d6d798339572d2abc96b66e97ea62ac">resultsetfm_t</a>* single_forwardmodel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#a094bcc9790c7865c0a721078d5334420">single_fm_likelihood_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single Partition Forward Model. </p>
<p>A single partition 1D forward model is essentially attempting to solve for a number of parameters. A range of these parameters is supplied via the parameters parameter.</p>
<p>The user supplied callback function, lp, will be passed at each iteration a set of parameters in an array. The callback should calculate negative log likelihood of the model (note that multiplicative and additive constants can be left out as these will cancel) . For an uncorrelated gaussian, this simplifies to (and removing the additive constant):</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \log({\mathrm{likelihood}}) = \sum_{i = 1}^n \frac{\left(g\left(m\right)_i - d_i\right)^2}{2 \sigma_i^2} \]" src="form_0.png"/>
</p>
<p>From the actual likelihood:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Pr(d|m) = \frac{1}{\prod_{i=1}^n \sqrt{2 \pi \cdot \sigma_i^2}} \exp{\left( \sum_{i = 1}^n \frac{-\left(g\left(m\right)_i - d_i\right)^2}{2\sigma_i^2}\right)} \]" src="form_1.png"/>
</p>
<p>Where <img class="formulaInl" alt="$g(m)_i$" src="form_2.png"/> is the data/model generated from the parameters passed to the function, <img class="formulaInl" alt="$d_i$" src="form_3.png"/> is the data/model to compare, and . <img class="formulaInl" alt="$\sigma_i$" src="form_4.png"/> is the variance of the noise or uncertainty in the data. If the variance is not known and set to unity, the simulation will tend to overfit the data (unless the variance is actually near 1). In this case it is recommended that the <a class="el" href="forwardmodel_8h.html#a95b892df15e3e7b58497a68af64a7b0d" title="Single Partition Forward Model with Hierarchical Noise. ">single_forwardmodel_hierarchical</a> function be used instead as it will also perturb an estimate of <img class="formulaInl" alt="$\sigma$" src="form_5.png"/>. Note that we don't need to calculate the scaling constant for the gaussian probability in this case since it is cancelled out in the MCMC step. This is not the case for the hierarchical version <a class="el" href="forwardmodel_8h.html#a95b892df15e3e7b58497a68af64a7b0d" title="Single Partition Forward Model with Hierarchical Noise. ">single_forwardmodel_hierarchical</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">burnin</td><td>The number of burn in iterations. </td></tr>
    <tr><td class="paramname">total</td><td>The total number of iterations (must be greater than burnin). </td></tr>
    <tr><td class="paramname">random</td><td>User supplied uniform random number generator. </td></tr>
    <tr><td class="paramname">normal</td><td>User supplied normal random number generator. </td></tr>
    <tr><td class="paramname">nparameters</td><td>The number of parameters in the forward model. </td></tr>
    <tr><td class="paramname">parameters</td><td>The array of parameter information. </td></tr>
    <tr><td class="paramname">lp</td><td>The hierarchical likelihood function. </td></tr>
    <tr><td class="paramname">user_arg</td><td>A pointer to user data that will be supplied to the likelihood function. </td></tr>
    <tr><td class="paramname">samples</td><td>Results such as median, mode, credible intervals are computed using a histogram of values, this parameter sets the number of bins for this histogram. A value of 100 suits most cases. </td></tr>
    <tr><td class="paramname">credible_interval</td><td>The credible interval expressed as a percentage between 0 and 1. </td></tr>
    <tr><td class="paramname">results</td><td>The results desired as a bitwise or'ing of <a class="el" href="resultsetfm_8h.html#a0a616a91a93740d092f8eee57f16b920">resultsetfm_result_t</a> values.</td></tr>
  </table>
  </dd>
</dl>
<p>For an example of using this function, see the example 1d/single/fm/simpleimage/simpleimage.c </p>

<p>References <a class="el" href="structfmsingle.html#a3d260e319a4ddae6e4647835c0bd4071">fmsingle::current</a>, <a class="el" href="structfmsingle.html#adc525ed1a81e4d7f5d687d96af6ce888">fmsingle::current_hierarchical</a>, <a class="el" href="structfmsingle.html#ace5bdca44f6db9697e6ccb4cc084b212">fmsingle::current_like</a>, <a class="el" href="structfmsingle.html#afa03012e995c260d955674113a36f2e5">fmsingle::current_logdetce</a>, <a class="el" href="structfmsingle.html#a7f7e040a5e4ad525258791dc802a8d7d">fmsingle::hierarchicalparameters</a>, <a class="el" href="structfmsingle.html#a8461a52c9112de045c4276da3eca60ec">fmsingle::lp</a>, <a class="el" href="structfmsingle.html#ae4b5351778dc439e3e8a23e5ab63f26f">fmsingle::lp_hierarchical</a>, <a class="el" href="structfmsingle.html#a5de749dceaf19fb0388f6c9749aa5e44">fmsingle::nhierarchicalparameters</a>, <a class="el" href="structfmsingle.html#a70e043c1b30c30777ff0725ee90151a3">fmsingle::normal</a>, <a class="el" href="structfmsingle.html#af08f6c83aca46c43c647e5ddb112e970">fmsingle::nparameters</a>, <a class="el" href="structfmsingle.html#a24fbe662b9150ff39a04ca7be2e1350a">fmsingle::nsamples</a>, <a class="el" href="structfmsingle.html#ab1234622eb6c5c5ba6d9b4ea55e8b90c">fmsingle::out</a>, <a class="el" href="structfmsingle.html#afee4062457521ceedd7fef33d3384ce5">fmsingle::parameters</a>, <a class="el" href="structfmsingle.html#ad3fa1724fad1be77f25e08e3e740263b">fmsingle::process</a>, <a class="el" href="structfmsingle.html#a70956154a388f5de33b0e9e8ccc6f172">fmsingle::proposed</a>, <a class="el" href="structfmsingle.html#a920535078a203fc1c06c04b0c370ab26">fmsingle::proposed_hierarchical</a>, <a class="el" href="structfmsingle.html#a91bacb67e5d416c9210619c950f1cbb2">fmsingle::proposed_like</a>, <a class="el" href="structfmsingle.html#a6f5f9b059e8099d77d4ad5c1ba0d9ebb">fmsingle::proposed_logdetce</a>, <a class="el" href="structfmsingle.html#aabc852b5e142570044ef6ac8803158ef">fmsingle::random</a>, <a class="el" href="structfmsingle.html#a7264d52b1fa07698c747ce50c9b81553">fmsingle::results</a>, <a class="el" href="resultsetfm_8c.html#a94f1fae530228d3149fcce17dd35a14c">resultsetfm_assemble_results()</a>, <a class="el" href="resultsetfm_8c.html#abe125c00cc57c6515cc91ef298d955fb">resultsetfm_create()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="rjmcmcf__mpi_8h.html#a30e374d8d017c0854f714c208aea6512">samples</a>, and <a class="el" href="structfmsingle.html#afdda5c6d655200456d36d1db08bfc98e">fmsingle::user_arg</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#a11799898f79291bad341135f00b7a243">single_forwardmodel_f()</a>.</p>

</div>
</div>
<a class="anchor" id="a95b892df15e3e7b58497a68af64a7b0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="resultsetfm_8h.html#a6d6d798339572d2abc96b66e97ea62ac">resultsetfm_t</a>* single_forwardmodel_hierarchical </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>burnin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#accc36e83459ada552d8f70962190dac0">rjmcmc_uniform_rand_t</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rjmcmc__random_8h.html#a498625755d377b68ad37c9ab360e83b0">rjmcmc_normal_rand_t</a>&#160;</td>
          <td class="paramname"><em>normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nhierarchicalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="forwardmodelparameter_8h.html#a18a7d2fd51fab097145725d83ac328e3">forwardmodelparameter_t</a> *&#160;</td>
          <td class="paramname"><em>hierarchicalparameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="forwardmodel_8h.html#a20a68d1e54609fed41954a0469e16d2c">single_fm_likelihood_hierarchical_t</a>&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>credible_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single Partition Forward Model with Hierarchical Noise. </p>
<p>This forward model adds a custom number of hierarchical parameters that affect the scaling constant of the likelihood and therefore the log(likelihood) that needs to be returned from the likelihood function.</p>
<p>The general gaussian probability is:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Pr() = \frac{1}{(2 \pi)^{n/2} |C_e|} \exp{-\frac{1}{2}(g(m) - d)^T C_e^{-1} (g(m) - d)} \]" src="form_6.png"/>
</p>
<p>Where <img class="formulaInl" alt="$ C_e $" src="form_7.png"/> is the covariance matrix that is generated from the hierarchical parameters. In the simplest case you would have 1 hierarchical parameter with the diagonal of the covariance matrix set to this value.</p>
<p>The callback function now needs to calculate the entire likelihood value but only when the hierarchical parameters are perturbed. To facilitate this and to allow some efficiency gains in not having to continuously evaluate the determinant of the covariance matrix, the callback function only needs to return the positive value of the exponential term above, ie <img class="formulaInl" alt="$\frac{1}{2}(g(m) - d)^T C_e^{-1} (g(m) - d)$" src="form_8.png"/>, and the determinant of the covariance when needed. This is indicated with the hierarchical parameter to the callback function. In psuedo code, the callback function should follow the following pattern: </p><pre class="fragment">loglikelihood = calculate_log_likelihood();
if (hierarchical == 1) {
     logdetce = calculate_log_detCe();
} 

return loglikelihood;
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">burnin</td><td>The number of burn in iterations. </td></tr>
    <tr><td class="paramname">total</td><td>The total number of iterations (must be greater than burnin). </td></tr>
    <tr><td class="paramname">random</td><td>User supplied uniform random number generator. </td></tr>
    <tr><td class="paramname">normal</td><td>User supplied normal random number generator. </td></tr>
    <tr><td class="paramname">nparameters</td><td>The number of parameters in the forward model. </td></tr>
    <tr><td class="paramname">parameters</td><td>The array of parameter information. </td></tr>
    <tr><td class="paramname">nhierarchicalparameters</td><td>The number of hierarchical parameters to sample </td></tr>
    <tr><td class="paramname">hierarchicalparameters</td><td></td></tr>
    <tr><td class="paramname">lp</td><td>The hierarchical likelihood function. Note that this has a different signature than the <a class="el" href="forwardmodel_8h.html#a65b1200fd2ef808c85b1915fa1413b58" title="Single Partition Forward Model. ">single_forwardmodel</a> function parameter of the same name. </td></tr>
    <tr><td class="paramname">user_arg</td><td>A pointer to user data that will be supplied to the likelihood function. </td></tr>
    <tr><td class="paramname">nsamples</td><td>The number of data points used in calculating the likelihood. </td></tr>
    <tr><td class="paramname">credible_interval</td><td>The credible interval expressed as a percentage between 0 and 1. </td></tr>
    <tr><td class="paramname">results</td><td>The results desired as a bitwise or'ing of <a class="el" href="resultsetfm_8h.html#a0a616a91a93740d092f8eee57f16b920">resultsetfm_result_t</a> values.</td></tr>
  </table>
  </dd>
</dl>
<p>For an example of using this function, see the example 1d/single/fm/simpleimage/simpleimage.c </p>

<p>References <a class="el" href="structfmsingle.html#a3d260e319a4ddae6e4647835c0bd4071">fmsingle::current</a>, <a class="el" href="structfmsingle.html#adc525ed1a81e4d7f5d687d96af6ce888">fmsingle::current_hierarchical</a>, <a class="el" href="structfmsingle.html#ace5bdca44f6db9697e6ccb4cc084b212">fmsingle::current_like</a>, <a class="el" href="structfmsingle.html#afa03012e995c260d955674113a36f2e5">fmsingle::current_logdetce</a>, <a class="el" href="struct__forwardmodelparameter.html#aa028b68fc0f738b4d578e90751ffaa24">_forwardmodelparameter::fmax</a>, <a class="el" href="struct__forwardmodelparameter.html#aced3d685a9701e3488ac78093a4e4733">_forwardmodelparameter::fmin</a>, <a class="el" href="struct__forwardmodelparameter.html#a08b65584a090a79dce5dc91aaced7bbe">_forwardmodelparameter::fstd_value</a>, <a class="el" href="structfmsingle.html#a7f7e040a5e4ad525258791dc802a8d7d">fmsingle::hierarchicalparameters</a>, <a class="el" href="structfmsingle.html#a8461a52c9112de045c4276da3eca60ec">fmsingle::lp</a>, <a class="el" href="structfmsingle.html#ae4b5351778dc439e3e8a23e5ab63f26f">fmsingle::lp_hierarchical</a>, <a class="el" href="structfmsingle.html#a5de749dceaf19fb0388f6c9749aa5e44">fmsingle::nhierarchicalparameters</a>, <a class="el" href="structfmsingle.html#a70e043c1b30c30777ff0725ee90151a3">fmsingle::normal</a>, <a class="el" href="structfmsingle.html#af08f6c83aca46c43c647e5ddb112e970">fmsingle::nparameters</a>, <a class="el" href="structfmsingle.html#a24fbe662b9150ff39a04ca7be2e1350a">fmsingle::nsamples</a>, <a class="el" href="structfmsingle.html#ab1234622eb6c5c5ba6d9b4ea55e8b90c">fmsingle::out</a>, <a class="el" href="structfmsingle.html#afee4062457521ceedd7fef33d3384ce5">fmsingle::parameters</a>, <a class="el" href="structfmsingle.html#ad3fa1724fad1be77f25e08e3e740263b">fmsingle::process</a>, <a class="el" href="structfmsingle.html#a70956154a388f5de33b0e9e8ccc6f172">fmsingle::proposed</a>, <a class="el" href="structfmsingle.html#a920535078a203fc1c06c04b0c370ab26">fmsingle::proposed_hierarchical</a>, <a class="el" href="structfmsingle.html#a91bacb67e5d416c9210619c950f1cbb2">fmsingle::proposed_like</a>, <a class="el" href="structfmsingle.html#a6f5f9b059e8099d77d4ad5c1ba0d9ebb">fmsingle::proposed_logdetce</a>, <a class="el" href="structfmsingle.html#aabc852b5e142570044ef6ac8803158ef">fmsingle::random</a>, <a class="el" href="structfmsingle.html#a7264d52b1fa07698c747ce50c9b81553">fmsingle::results</a>, <a class="el" href="resultsetfm_8c.html#a9648b66d07a9058afd12e92352805bb4">resultsetfm_accept()</a>, <a class="el" href="resultsetfm_8c.html#a94f1fae530228d3149fcce17dd35a14c">resultsetfm_assemble_results()</a>, <a class="el" href="resultsetfm_8c.html#abe125c00cc57c6515cc91ef298d955fb">resultsetfm_create()</a>, <a class="el" href="resultsetfm_8c.html#a8fcad48d629d5f32605b3f10b87423ee">resultsetfm_propose()</a>, <a class="el" href="resultsetfm_8c.html#a71572783379ba6d16505c60dec973da1">resultsetfm_sample()</a>, <a class="el" href="resultsetfm_8c.html#a5b6478a6af7171f4ed060f554b581ecf">resultsetfm_sample_hierarchical()</a>, <a class="el" href="resultsetfm_8c.html#ad46ce79866954ba65a96a06f3b14c271">resultsetfm_sample_misfit()</a>, <a class="el" href="rjmcmc__util_8c.html#a26a1113b542fb7250c98e13b8465332b">rjmcmc_create_array_1d()</a>, <a class="el" href="rjmcmc__util_8c.html#a66c84ced6c0367edf1e03c8c92f3e48d">rjmcmc_destroy_array_1d()</a>, <a class="el" href="engine_8c.html#a830d7f4cc1a90d2aa826cf5f1f189734">rjmcmc_engine_run()</a>, <a class="el" href="rjmcmc__debug_8c.html#a540536502992ae80e5e3377b18d08974">rjmcmc_error()</a>, <a class="el" href="rjmcmc__random_8c.html#ab99a758b14f2202bfd823164b4f67640">rjmcmc_random_choose_double()</a>, <a class="el" href="rjmcmc__random_8c.html#a82b6b15bdb127fea0987cec9c75cf3fe">rjmcmc_random_choose_int()</a>, <a class="el" href="rjmcmcf__mpi_8h.html#a30e374d8d017c0854f714c208aea6512">samples</a>, and <a class="el" href="structfmsingle.html#afdda5c6d655200456d36d1db08bfc98e">fmsingle::user_arg</a>.</p>

<p>Referenced by <a class="el" href="forwardmodel__f_8h.html#a422ef5c08bc9ef2b35b63e135bdf45fa">single_forwardmodel_hierarchical_f()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 31 2016 10:43:25 for rjmcmc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
