\hypertarget{regression_8c}{}\section{regression.\+c File Reference}
\label{regression_8c}\index{regression.\+c@{regression.\+c}}
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$float.\+h$>$}\\*
{\ttfamily \#include $<$rjmcmc/regression.\+h$>$}\\*
{\ttfamily \#include $<$rjmcmc/engine.\+h$>$}\\*
{\ttfamily \#include $<$rjmcmc/resultset1d.\+h$>$}\\*
{\ttfamily \#include $<$rjmcmc/single1d\+\_\+regression.\+h$>$}\\*
{\ttfamily \#include $<$rjmcmc/dataset1d.\+h$>$}\\*
{\ttfamily \#include $<$rjmcmc/rjmcmc\+\_\+util.\+h$>$}\\*
{\ttfamily \#include $<$rjmcmc/curvefit.\+h$>$}\\*
Include dependency graph for regression.\+c\+:
% FIG 0
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structsingle1d}{single1d}
\item 
struct \hyperlink{structmpi__data}{mpi\+\_\+data}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef void($\ast$ \hyperlink{regression_8c_a68ff29f945077dd8bc305638f324e994}{resultassembler\+\_\+t}) (void $\ast$user, \hyperlink{resultset1d_8h_ae2ef1c63a8e796e51d39d8b7c2cdfa72}{resultset1d\+\_\+t} $\ast$r)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{resultset1d_8h_ae2ef1c63a8e796e51d39d8b7c2cdfa72}{resultset1d\+\_\+t} $\ast$ \hyperlink{regression_8c_a037d789bc3de5c4c55b0c781193ae3b7}{single1d\+\_\+regression} (const \hyperlink{dataset1d_8h_a232f8372957af83ed6a261e9b89dd8f6}{dataset1d\+\_\+t} $\ast$dataset, int burnin, int \hyperlink{rjmcmcf__mpi_8h_a1829e955eab35ef63200105c2de1ad94}{total}, int max\+\_\+order, int xsamples, int ysamples, double \hyperlink{rjmcmcf__mpi_8h_a5a7722a5cc210713ec1b3956fde06e70}{credible\+\_\+interval}, \hyperlink{rjmcmc__random_8h_accc36e83459ada552d8f70962190dac0}{rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t} \hyperlink{rjmcmcf__mpi_8h_a361f30102277b1d490d4edc190afccf6}{random}, \hyperlink{rjmcmc__random_8h_a498625755d377b68ad37c9ab360e83b0}{rjmcmc\+\_\+normal\+\_\+rand\+\_\+t} \hyperlink{rjmcmcf__mpi_8h_a6304ff7c79f9217c47a3373e460e3cfc}{normal}, int results, \hyperlink{regression_8h_ae892a560d7749e7aa48352b053c54a26}{regression1d\+\_\+cb\+\_\+t} user\+\_\+callback, void $\ast$\hyperlink{rjmcmcf__mpi_8h_ab68b3a27bfe943a73cf680c2e439e070}{user\+\_\+arg})
\begin{DoxyCompactList}\small\item\em Single Partition Regression. \end{DoxyCompactList}\item 
\hyperlink{resultset1d_8h_ae2ef1c63a8e796e51d39d8b7c2cdfa72}{resultset1d\+\_\+t} $\ast$ \hyperlink{regression_8c_ac8c2d9357e8a0ac1ff03fc48843e804b}{single1d\+\_\+regression\+\_\+with\+\_\+prior} (const \hyperlink{dataset1d_8h_a232f8372957af83ed6a261e9b89dd8f6}{dataset1d\+\_\+t} $\ast$dataset, const double $\ast$prior, int burnin, int \hyperlink{rjmcmcf__mpi_8h_a1829e955eab35ef63200105c2de1ad94}{total}, int max\+\_\+order, int xsamples, int ysamples, double \hyperlink{rjmcmcf__mpi_8h_a5a7722a5cc210713ec1b3956fde06e70}{credible\+\_\+interval}, \hyperlink{rjmcmc__random_8h_accc36e83459ada552d8f70962190dac0}{rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t} \hyperlink{rjmcmcf__mpi_8h_a361f30102277b1d490d4edc190afccf6}{random}, \hyperlink{rjmcmc__random_8h_a498625755d377b68ad37c9ab360e83b0}{rjmcmc\+\_\+normal\+\_\+rand\+\_\+t} \hyperlink{rjmcmcf__mpi_8h_a6304ff7c79f9217c47a3373e460e3cfc}{normal}, int results, \hyperlink{regression_8h_ae892a560d7749e7aa48352b053c54a26}{regression1d\+\_\+cb\+\_\+t} user\+\_\+callback, void $\ast$\hyperlink{rjmcmcf__mpi_8h_ab68b3a27bfe943a73cf680c2e439e070}{user\+\_\+arg})
\begin{DoxyCompactList}\small\item\em Single Partition Regression with a custom prior. \end{DoxyCompactList}\item 
\hyperlink{resultset1d_8h_ae2ef1c63a8e796e51d39d8b7c2cdfa72}{resultset1d\+\_\+t} $\ast$ \hyperlink{regression_8c_a0ab9525ab0dc478cfa18bc9bd5a94d97}{single1d\+\_\+direct\+\_\+regression} (const \hyperlink{dataset1d_8h_a232f8372957af83ed6a261e9b89dd8f6}{dataset1d\+\_\+t} $\ast$dataset, const double $\ast$fixed\+\_\+prior, int max\+\_\+order, int xsamples, \hyperlink{rjmcmc__random_8h_accc36e83459ada552d8f70962190dac0}{rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t} \hyperlink{rjmcmcf__mpi_8h_a361f30102277b1d490d4edc190afccf6}{random}, \hyperlink{rjmcmc__random_8h_a498625755d377b68ad37c9ab360e83b0}{rjmcmc\+\_\+normal\+\_\+rand\+\_\+t} \hyperlink{rjmcmcf__mpi_8h_a6304ff7c79f9217c47a3373e460e3cfc}{normal})
\begin{DoxyCompactList}\small\item\em Single Partition Regression with direct integration. \end{DoxyCompactList}\item 
\hyperlink{resultset1d_8h_ae2ef1c63a8e796e51d39d8b7c2cdfa72}{resultset1d\+\_\+t} $\ast$ \hyperlink{regression_8c_ad0423aa92498a62a597c43238855b896}{M\+P\+I\+\_\+single1d\+\_\+regression} (const \hyperlink{dataset1d_8h_a232f8372957af83ed6a261e9b89dd8f6}{dataset1d\+\_\+t} $\ast$dataset, int burnin, int \hyperlink{rjmcmcf__mpi_8h_a1829e955eab35ef63200105c2de1ad94}{total}, int max\+\_\+order, int xsamples, int ysamples, double \hyperlink{rjmcmcf__mpi_8h_a5a7722a5cc210713ec1b3956fde06e70}{credible\+\_\+interval}, \hyperlink{rjmcmc__random_8h_accc36e83459ada552d8f70962190dac0}{rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t} \hyperlink{rjmcmcf__mpi_8h_a361f30102277b1d490d4edc190afccf6}{random}, \hyperlink{rjmcmc__random_8h_a498625755d377b68ad37c9ab360e83b0}{rjmcmc\+\_\+normal\+\_\+rand\+\_\+t} \hyperlink{rjmcmcf__mpi_8h_a6304ff7c79f9217c47a3373e460e3cfc}{normal}, int results, \hyperlink{regression_8h_ae892a560d7749e7aa48352b053c54a26}{regression1d\+\_\+cb\+\_\+t} user\+\_\+callback, void $\ast$\hyperlink{rjmcmcf__mpi_8h_ab68b3a27bfe943a73cf680c2e439e070}{user\+\_\+arg}, int \hyperlink{rjmcmcf__mpi_8h_a53444b4c2f1bed79dc9d81c1375a3dae}{mpisize}, int \hyperlink{rjmcmcf__mpi_8h_aa638dce228df69587d0bf089358637da}{mpirank}, int \hyperlink{rjmcmcf__mpi_8h_a2b5687688a1de905e5c06a65264ae216}{root}, M\+P\+I\+\_\+\+Comm comm)
\end{DoxyCompactItemize}


\subsection{Typedef Documentation}
\index{regression.\+c@{regression.\+c}!resultassembler\+\_\+t@{resultassembler\+\_\+t}}
\index{resultassembler\+\_\+t@{resultassembler\+\_\+t}!regression.\+c@{regression.\+c}}
\subsubsection[{\texorpdfstring{resultassembler\+\_\+t}{resultassembler_t}}]{\setlength{\rightskip}{0pt plus 5cm}typedef void($\ast$ resultassembler\+\_\+t) (void $\ast$user, {\bf resultset1d\+\_\+t} $\ast$r)}\hypertarget{regression_8c_a68ff29f945077dd8bc305638f324e994}{}\label{regression_8c_a68ff29f945077dd8bc305638f324e994}


\subsection{Function Documentation}
\index{regression.\+c@{regression.\+c}!M\+P\+I\+\_\+single1d\+\_\+regression@{M\+P\+I\+\_\+single1d\+\_\+regression}}
\index{M\+P\+I\+\_\+single1d\+\_\+regression@{M\+P\+I\+\_\+single1d\+\_\+regression}!regression.\+c@{regression.\+c}}
\subsubsection[{\texorpdfstring{M\+P\+I\+\_\+single1d\+\_\+regression(const dataset1d\+\_\+t $\ast$dataset, int burnin, int total, int max\+\_\+order, int xsamples, int ysamples, double credible\+\_\+interval, rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t random, rjmcmc\+\_\+normal\+\_\+rand\+\_\+t normal, int results, regression1d\+\_\+cb\+\_\+t user\+\_\+callback, void $\ast$user\+\_\+arg, int mpisize, int mpirank, int root, M\+P\+I\+\_\+\+Comm comm)}{MPI_single1d_regression(const dataset1d_t *dataset, int burnin, int total, int max_order, int xsamples, int ysamples, double credible_interval, rjmcmc_uniform_rand_t random, rjmcmc_normal_rand_t normal, int results, regression1d_cb_t user_callback, void *user_arg, int mpisize, int mpirank, int root, MPI_Comm comm)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf resultset1d\+\_\+t}$\ast$ M\+P\+I\+\_\+single1d\+\_\+regression (
\begin{DoxyParamCaption}
\item[{const {\bf dataset1d\+\_\+t} $\ast$}]{dataset, }
\item[{int}]{burnin, }
\item[{int}]{total, }
\item[{int}]{max\+\_\+order, }
\item[{int}]{xsamples, }
\item[{int}]{ysamples, }
\item[{double}]{credible\+\_\+interval, }
\item[{{\bf rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t}}]{random, }
\item[{{\bf rjmcmc\+\_\+normal\+\_\+rand\+\_\+t}}]{normal, }
\item[{int}]{results, }
\item[{{\bf regression1d\+\_\+cb\+\_\+t}}]{user\+\_\+callback, }
\item[{void $\ast$}]{user\+\_\+arg, }
\item[{int}]{mpisize, }
\item[{int}]{mpirank, }
\item[{int}]{root, }
\item[{M\+P\+I\+\_\+\+Comm}]{comm}
\end{DoxyParamCaption}
)}\hypertarget{regression_8c_ad0423aa92498a62a597c43238855b896}{}\label{regression_8c_ad0423aa92498a62a597c43238855b896}


References mpi\+\_\+data\+::comm, single1d\+::current, single1d\+::current\+\_\+like, single1d\+::dataset, single1d\+::lambda\+\_\+prob, mpirank, mpisize, single1d\+::normal, single1d\+::nprocesses, single1d\+::out, single1d\+::process, single1d\+::proposed, single1d\+::proposed\+\_\+like, single1d\+::random, mpi\+\_\+data\+::rank, single1d\+::results, resultset1d\+\_\+accept(), resultset1d\+\_\+propose(), resultset1d\+\_\+sample(), resultset1d\+\_\+sample\+\_\+lambda(), resultset1d\+\_\+sample\+\_\+misfit(), resultset1d\+\_\+sample\+\_\+order(), rjmcmc\+\_\+error(), rjmcmc\+\_\+random\+\_\+choose\+\_\+int(), root, mpi\+\_\+data\+::root, single1d\+\_\+regression\+\_\+clone(), single1d\+\_\+regression\+\_\+evaluate(), single1d\+\_\+regression\+\_\+initialize(), single1d\+\_\+regression\+\_\+lambda(), single1d\+\_\+regression\+\_\+misfit(), single1d\+\_\+regression\+\_\+order(), single1d\+\_\+regression\+\_\+propose\+\_\+lambda(), single1d\+\_\+regression\+\_\+propose\+\_\+value(), mpi\+\_\+data\+::size, single1d\+::v, single1d\+::value\+\_\+prob, \+\_\+dataset1d\+::xmax, \+\_\+dataset1d\+::xmin, and single1d\+::xsamples.

\index{regression.\+c@{regression.\+c}!single1d\+\_\+direct\+\_\+regression@{single1d\+\_\+direct\+\_\+regression}}
\index{single1d\+\_\+direct\+\_\+regression@{single1d\+\_\+direct\+\_\+regression}!regression.\+c@{regression.\+c}}
\subsubsection[{\texorpdfstring{single1d\+\_\+direct\+\_\+regression(const dataset1d\+\_\+t $\ast$dataset, const double $\ast$fixed\+\_\+prior, int max\+\_\+order, int xsamples, rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t random, rjmcmc\+\_\+normal\+\_\+rand\+\_\+t normal)}{single1d_direct_regression(const dataset1d_t *dataset, const double *fixed_prior, int max_order, int xsamples, rjmcmc_uniform_rand_t random, rjmcmc_normal_rand_t normal)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf resultset1d\+\_\+t}$\ast$ single1d\+\_\+direct\+\_\+regression (
\begin{DoxyParamCaption}
\item[{const {\bf dataset1d\+\_\+t} $\ast$}]{dataset, }
\item[{const double $\ast$}]{fixed\+\_\+prior, }
\item[{int}]{max\+\_\+order, }
\item[{int}]{xsamples, }
\item[{{\bf rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t}}]{random, }
\item[{{\bf rjmcmc\+\_\+normal\+\_\+rand\+\_\+t}}]{normal}
\end{DoxyParamCaption}
)}\hypertarget{regression_8c_a0ab9525ab0dc478cfa18bc9bd5a94d97}{}\label{regression_8c_a0ab9525ab0dc478cfa18bc9bd5a94d97}


Single Partition Regression with direct integration. 

The \hyperlink{regression_8h_a037d789bc3de5c4c55b0c781193ae3b7}{single1d\+\_\+regression} samples the fit of polynomials drawn from a distribution but it is possible to integrate these out directly and avoid the stochastic sampling process. The benefit of this is that the regression is performed quicker. The downside is that results such as credible intervals are unavailable. 

References curvefit\+\_\+create(), curvefit\+\_\+evaluate\+\_\+pk(), single1d\+::det\+Cm, single1d\+::kcdf, single1d\+::max\+\_\+order, single1d\+::mean, single1d\+::mean\+\_\+misfit, \+\_\+dataset1d\+::npoints, single1d\+::pk, single1d\+::results, resultset1d\+\_\+create(), R\+E\+S\+U\+L\+T\+S\+E\+T1\+D\+\_\+\+M\+E\+AN, resultset1d\+\_\+sample(), rjmcmc\+\_\+create\+\_\+array\+\_\+1d(), rjmcmc\+\_\+create\+\_\+array\+\_\+2d(), rjmcmc\+\_\+destroy\+\_\+array\+\_\+1d(), rjmcmc\+\_\+destroy\+\_\+array\+\_\+2d(), rjmcmc\+\_\+error(), rjmcmc\+\_\+polynomial\+\_\+value(), single1d\+::S, single1d\+::sigma, x, \+\_\+dataset1d\+::xmax, \+\_\+dataset1d\+::xmin, \+\_\+dataset1d\+::ymax, and \+\_\+dataset1d\+::ymin.

\index{regression.\+c@{regression.\+c}!single1d\+\_\+regression@{single1d\+\_\+regression}}
\index{single1d\+\_\+regression@{single1d\+\_\+regression}!regression.\+c@{regression.\+c}}
\subsubsection[{\texorpdfstring{single1d\+\_\+regression(const dataset1d\+\_\+t $\ast$dataset, int burnin, int total, int max\+\_\+order, int xsamples, int ysamples, double credible\+\_\+interval, rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t random, rjmcmc\+\_\+normal\+\_\+rand\+\_\+t normal, int results, regression1d\+\_\+cb\+\_\+t user\+\_\+callback, void $\ast$user\+\_\+arg)}{single1d_regression(const dataset1d_t *dataset, int burnin, int total, int max_order, int xsamples, int ysamples, double credible_interval, rjmcmc_uniform_rand_t random, rjmcmc_normal_rand_t normal, int results, regression1d_cb_t user_callback, void *user_arg)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf resultset1d\+\_\+t}$\ast$ single1d\+\_\+regression (
\begin{DoxyParamCaption}
\item[{const {\bf dataset1d\+\_\+t} $\ast$}]{dataset, }
\item[{int}]{burnin, }
\item[{int}]{total, }
\item[{int}]{max\+\_\+order, }
\item[{int}]{xsamples, }
\item[{int}]{ysamples, }
\item[{double}]{credible\+\_\+interval, }
\item[{{\bf rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t}}]{random, }
\item[{{\bf rjmcmc\+\_\+normal\+\_\+rand\+\_\+t}}]{normal, }
\item[{int}]{results, }
\item[{{\bf regression1d\+\_\+cb\+\_\+t}}]{user\+\_\+callback, }
\item[{void $\ast$}]{user\+\_\+arg}
\end{DoxyParamCaption}
)}\hypertarget{regression_8c_a037d789bc3de5c4c55b0c781193ae3b7}{}\label{regression_8c_a037d789bc3de5c4c55b0c781193ae3b7}


Single Partition Regression. 

The \hyperlink{regression_8h_a037d789bc3de5c4c55b0c781193ae3b7}{single1d\+\_\+regression} function performs a regression simulation on a single partition of the given dataset. It will attempt to fit trial polynomials of order 0 to order\+\_\+max and sampling acceptable polynomials at each order. The method of selecting the order of the polynomial (or the probability distribution of the order of the data) is outlined in {\bfseries [sambridge2006A]}.

The results are returned in a \hyperlink{resultset1d_8h_ae2ef1c63a8e796e51d39d8b7c2cdfa72}{resultset1d\+\_\+t} structure that can be interrogated with various functions in \+::resultset1d.\+h.

For example of the use of this function, see 1d/single/regression/cubic/cubic.\+c


\begin{DoxyParams}{Parameters}
{\em dataset} & The dataset to run the regression on. See the \hyperlink{dataset1d_8h_a12b327d93f135ffa89af1d4d2359f771}{dataset1d\+\_\+load\+\_\+known}, \+::dataset1d\+\_\+load\+\_\+estimated, and \hyperlink{dataset1d_8h_a8a3dee8031d5f30f9698874806bb33be}{dataset1d\+\_\+load\+\_\+fixed} functions. \\
\hline
{\em burnin} & The number of burn in iterations. \\
\hline
{\em total} & The total number of iterations. \\
\hline
{\em max\+\_\+order} & The maximum order of the polynomial to allow when fitting a trial curve to the data. \\
\hline
{\em xsamples} & The number of samples to use for discretization of the horizontal axis. \\
\hline
{\em ysamples} & The number of samples to use for discretization of the vertical axis when computing mode, median, and credible intervals. \\
\hline
{\em credible\+\_\+interval} & The credible interval to use for results expressed as a ratio, i.\+e. 0.\+95 for the 95\% credible interval. \\
\hline
{\em random} & A function pointer to uniform random number generator to use. See the \hyperlink{rjmcmc__random_8h_ab82b2ece8acc3f5a05ff2f270794f9be}{rjmcmc\+\_\+uniform} function. \\
\hline
{\em normal} & A function pointer to the normal random number generator for generating normally distributed random numbers with 0 mean and a standard deviation of 1. See the \hyperlink{rjmcmc__random_8h_a0f9b049cec5095e2e1c1b3488de1d5c0}{rjmcmc\+\_\+normal} function. \\
\hline
{\em results} & A bit mask of results to store. See \hyperlink{resultset1d_8h_a1fffe49407333be24faf49976523f7a0}{resultset1d\+\_\+result\+\_\+t}. \\
\hline
{\em user\+\_\+callback} & An optional callback function to do your own sampling of the generated curves. Set to N\+U\+LL if you don\textquotesingle{}t need this. \\
\hline
{\em user\+\_\+arg} & A user pointer to pass to the callback function. \\
\hline
\end{DoxyParams}
\begin{Desc}
\item[Examples\+: ]\par
\hyperlink{1d_2single_2regression_2cubic_2cubic_8c-example}{1d/single/regression/cubic/cubic.\+c}.\end{Desc}
\index{regression.\+c@{regression.\+c}!single1d\+\_\+regression\+\_\+with\+\_\+prior@{single1d\+\_\+regression\+\_\+with\+\_\+prior}}
\index{single1d\+\_\+regression\+\_\+with\+\_\+prior@{single1d\+\_\+regression\+\_\+with\+\_\+prior}!regression.\+c@{regression.\+c}}
\subsubsection[{\texorpdfstring{single1d\+\_\+regression\+\_\+with\+\_\+prior(const dataset1d\+\_\+t $\ast$dataset, const double $\ast$prior, int burnin, int total, int max\+\_\+order, int xsamples, int ysamples, double credible\+\_\+interval, rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t random, rjmcmc\+\_\+normal\+\_\+rand\+\_\+t normal, int results, regression1d\+\_\+cb\+\_\+t user\+\_\+callback, void $\ast$user\+\_\+arg)}{single1d_regression_with_prior(const dataset1d_t *dataset, const double *prior, int burnin, int total, int max_order, int xsamples, int ysamples, double credible_interval, rjmcmc_uniform_rand_t random, rjmcmc_normal_rand_t normal, int results, regression1d_cb_t user_callback, void *user_arg)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf resultset1d\+\_\+t}$\ast$ single1d\+\_\+regression\+\_\+with\+\_\+prior (
\begin{DoxyParamCaption}
\item[{const {\bf dataset1d\+\_\+t} $\ast$}]{dataset, }
\item[{const double $\ast$}]{prior, }
\item[{int}]{burnin, }
\item[{int}]{total, }
\item[{int}]{max\+\_\+order, }
\item[{int}]{xsamples, }
\item[{int}]{ysamples, }
\item[{double}]{credible\+\_\+interval, }
\item[{{\bf rjmcmc\+\_\+uniform\+\_\+rand\+\_\+t}}]{random, }
\item[{{\bf rjmcmc\+\_\+normal\+\_\+rand\+\_\+t}}]{normal, }
\item[{int}]{results, }
\item[{{\bf regression1d\+\_\+cb\+\_\+t}}]{user\+\_\+callback, }
\item[{void $\ast$}]{user\+\_\+arg}
\end{DoxyParamCaption}
)}\hypertarget{regression_8c_ac8c2d9357e8a0ac1ff03fc48843e804b}{}\label{regression_8c_ac8c2d9357e8a0ac1ff03fc48843e804b}


Single Partition Regression with a custom prior. 

Deprecated. Used for testing. 